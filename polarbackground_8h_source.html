<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>Votca: ctp/include/votca/ctp/polarbackground.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Votca
   &#160;<span id="projectnumber">1.3-dev</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_2b6ab31139d7f950fccda5a3d4ed6553.html">ctp</a></li><li class="navelem"><a class="el" href="dir_b7059f60e221f28f0137ac72cdbe3b94.html">include</a></li><li class="navelem"><a class="el" href="dir_16c9c2a526d05335730951a9adcc271a.html">votca</a></li><li class="navelem"><a class="el" href="dir_59eade378c16ec62c7343405c98c4d6f.html">ctp</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">polarbackground.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="polarbackground_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef VOTCA_CTP_POLARBACKGROUND_H</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define VOTCA_CTP_POLARBACKGROUND_H</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="ctp_2include_2votca_2ctp_2topology_8h.html">votca/ctp/topology.h</a>&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="polartop_8h.html">votca/ctp/polartop.h</a>&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="ewdspace_8h.html">votca/ctp/ewdspace.h</a>&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="ewaldactor_8h.html">votca/ctp/ewaldactor.h</a>&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="logger_8h.html">votca/ctp/logger.h</a>&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="qmthread_8h.html">votca/ctp/qmthread.h</a>&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;boost/archive/text_iarchive.hpp&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;boost/archive/text_oarchive.hpp&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">namespace </span>votca { <span class="keyword">namespace </span>ctp {    </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">namespace </span>EWD {</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html">   17</a></span>&#160;<span class="keyword">class </span><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html">PolarBackground</a></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;{</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a1f3ac3078bd368bab2fc72e8c784c138">   21</a></span>&#160;    <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a1f3ac3078bd368bab2fc72e8c784c138">PolarBackground</a>() : <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a420d6cbf02042750e5b918965ac3df7c">_top</a>(NULL), <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#aca97110013daeb48cfaf5de65f84ef7f">_ptop</a>(NULL), <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a36a2559ea43333c1411f8b70e81a34da">_log</a>(NULL), <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#affa5247fe99710053b15e045b2bc207b">_n_threads</a>(1) {};</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a1f3ac3078bd368bab2fc72e8c784c138">PolarBackground</a>(<a class="code" href="classvotca_1_1ctp_1_1Topology.html" title="Container for molecules, conjugated segments, rigid fragments, and atoms.">Topology</a> *top, <a class="code" href="classvotca_1_1ctp_1_1PolarTop.html">PolarTop</a> *ptop, <a class="code" href="classvotca_1_1tools_1_1Property.html" title="class to manage program options with xml serialization functionality">Property</a> *opt, <a class="code" href="classvotca_1_1ctp_1_1Logger.html" title="Logger is used for thread-safe output of messages.">Logger</a> *log, <span class="keywordtype">int</span> n_threads);</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;   <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a11411a618959e11afe1c00c9936c57e6">~PolarBackground</a>();</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;   </div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#ad809d1c0e152ff388cf3628bde33ce84">   25</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#ad809d1c0e152ff388cf3628bde33ce84">Threaded</a>(<span class="keywordtype">int</span> n_threads) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#affa5247fe99710053b15e045b2bc207b">_n_threads</a> = n_threads; }</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#afdbf5000b51ee42b3e60bd58aa761325">Polarize</a>();</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a36d6d66cf70e9e0435fe245bffb85b8d">FX_RealSpace</a>(<span class="keywordtype">string</span> mode, <span class="keywordtype">bool</span> do_setup_nbs);    </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#aec9e547d770338e7120dd8646955e325">FU_RealSpace</a>(<span class="keywordtype">bool</span> do_setup_nbs);</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a1ec353aa3c2d104e4fe9c53337bbaeb1">FX_ReciprocalSpace</a>(<span class="keywordtype">string</span> mode1, <span class="keywordtype">string</span> mode2, <span class="keywordtype">bool</span> generate_kvecs);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a9f464a7c25b34b6783bc1bb384f309c1">GenerateKVectors</a>(vector&lt;PolarSeg*&gt; &amp;ps1, vector&lt;PolarSeg*&gt; &amp;ps2);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// TODO Would be nicer to have as a local type in ::FP_RealSpace</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">//      (which is possible by compiling with --std=c++0x)</span></div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html">   36</a></span>&#160;    <span class="keyword">class </span><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html">FPThread</a> : <span class="keyword">public</span> <a class="code" href="classvotca_1_1ctp_1_1QMThread.html">QMThread</a></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="keyword">public</span>:        </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#a5b1d3524642172a042a4f4f8cac63d4c">FPThread</a>(<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html">PolarBackground</a> *master, <span class="keywordtype">int</span> <span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#ab5c7c8b6171318d05a6cb0b9d30aff66">   40</a></span>&#160;       <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#ab5c7c8b6171318d05a6cb0b9d30aff66">~FPThread</a>() { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#af4fbc88464bca469c665f8370404a4c6">_full_bg_P</a>.clear(); <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#af98c22d3f9ec665da73d8d1f15bb8fe1">_part_bg_P</a>.clear(); }       </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#a575df9c092bfcebcb953aa92e6e0a0c9" title="Run() executes the actual code. Overload it.">Run</a>(<span class="keywordtype">void</span>);        </div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#aeea6bdae78952029c520311a81e95f4c">   42</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#aeea6bdae78952029c520311a81e95f4c">AddPolarSeg</a>(<a class="code" href="classvotca_1_1ctp_1_1PolarSeg.html">PolarSeg</a> *pseg) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#af98c22d3f9ec665da73d8d1f15bb8fe1">_part_bg_P</a>.push_back(pseg); <span class="keywordflow">return</span>; }</div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#afe43f96595450379c081ee98d1322304">   43</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#afe43f96595450379c081ee98d1322304">Workload</a>() { <span class="keywordflow">return</span> 100.*<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#af98c22d3f9ec665da73d8d1f15bb8fe1">_part_bg_P</a>.size()/<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#af4fbc88464bca469c665f8370404a4c6">_full_bg_P</a>.size(); }</div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#ad9d93535a70fae8baca73ac55a541833">   44</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#ad9d93535a70fae8baca73ac55a541833">NotConverged</a>() { <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#a261ba16dd8b7331d6d4986d9e2abee86">_not_converged_count</a>; }</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#a2669706a113534c032aa99c862b791ec">   45</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#a2669706a113534c032aa99c862b791ec">AvgRco</a>() { <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#ab1d682b0b897a814330678e96d6209c9">_avg_R_co</a>; }</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#ae5934799894118ac80da1e284e257ca8">   46</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#ae5934799894118ac80da1e284e257ca8">DoSetupNbs</a>(<span class="keywordtype">bool</span> do_setup) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#abb746255d29a4be023f732f45d88c05d">_do_setup_nbs</a> = do_setup; }</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keyword">private</span>:        </div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#ac1ba791c6e647c0fba2ac6177a4372ab">   48</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#ac1ba791c6e647c0fba2ac6177a4372ab">_verbose</a>;</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#afe0d2e77d55270c7cd80034e365d4c17">   49</a></span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html">PolarBackground</a> *<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#afe0d2e77d55270c7cd80034e365d4c17">_master</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#aa182a43e3bb41229cc7ea1f4dcc6cb67">   50</a></span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EwdInteractor.html">EwdInteractor</a> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#aa182a43e3bb41229cc7ea1f4dcc6cb67">_ewdactor</a>;</div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#af4fbc88464bca469c665f8370404a4c6">   51</a></span>&#160;        vector&lt;PolarSeg*&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#af4fbc88464bca469c665f8370404a4c6">_full_bg_P</a>;</div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#af98c22d3f9ec665da73d8d1f15bb8fe1">   52</a></span>&#160;        vector&lt;PolarSeg*&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#af98c22d3f9ec665da73d8d1f15bb8fe1">_part_bg_P</a>;</div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#a261ba16dd8b7331d6d4986d9e2abee86">   53</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#a261ba16dd8b7331d6d4986d9e2abee86">_not_converged_count</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#ab1d682b0b897a814330678e96d6209c9">   54</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#ab1d682b0b897a814330678e96d6209c9">_avg_R_co</a>;</div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#abb746255d29a4be023f732f45d88c05d">   55</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FPThread.html#abb746255d29a4be023f732f45d88c05d">_do_setup_nbs</a>;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    };    </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    </div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html">   58</a></span>&#160;    <span class="keyword">class </span><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html">FUThread</a> : <span class="keyword">public</span> <a class="code" href="classvotca_1_1ctp_1_1QMThread.html">QMThread</a></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keyword">public</span>:        </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#ae599d4a64324c21b1056409297222849">FUThread</a>(<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html">PolarBackground</a> *master, <span class="keywordtype">int</span> <span class="keywordtype">id</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#ac60b504dd767c40bc5030f73413067b8">   62</a></span>&#160;       <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#ac60b504dd767c40bc5030f73413067b8">~FUThread</a>() { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a4edc8e5db51e7e9abd20ef1bf72ebafd">_full_bg_P</a>.clear(); <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a15c7e75444f768096014985d7148fc85">_part_bg_P</a>.clear(); }       </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a982c1f466afc7f736f99eb19b1c838a2" title="Run() executes the actual code. Overload it.">Run</a>(<span class="keywordtype">void</span>);        </div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a79c88720cc0f8cf8198fbefc04f8e411">   64</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a79c88720cc0f8cf8198fbefc04f8e411">AddPolarSeg</a>(<a class="code" href="classvotca_1_1ctp_1_1PolarSeg.html">PolarSeg</a> *pseg) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a15c7e75444f768096014985d7148fc85">_part_bg_P</a>.push_back(pseg); <span class="keywordflow">return</span>; }        </div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a80a04737a548b835ae21ca129ae2b99a">   65</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a80a04737a548b835ae21ca129ae2b99a">Workload</a>() { <span class="keywordflow">return</span> 100.*<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a15c7e75444f768096014985d7148fc85">_part_bg_P</a>.size()/<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a4edc8e5db51e7e9abd20ef1bf72ebafd">_full_bg_P</a>.size(); }</div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#af11493a4ca7c6bfa7ea7da4df400d88c">   66</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#af11493a4ca7c6bfa7ea7da4df400d88c">NotConverged</a>() { <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a9f4ce4f771c4a7e025a1edd850f66b8f">_not_converged_count</a>; }</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#aa9a3ea2bd0d63d1d649be6650340e3ac">   67</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#aa9a3ea2bd0d63d1d649be6650340e3ac">AvgRco</a>() { <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#abd94f31302defa44d8ee141bf184e5db">_avg_R_co</a>; }</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a00e662366a859c83279d3945df16b5f1">   68</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a00e662366a859c83279d3945df16b5f1">DoSetupNbs</a>(<span class="keywordtype">bool</span> do_setup) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a287fadd976b602a542d3c5a506fe7ce0">_do_setup_nbs</a> = do_setup; }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a8cb3d1c03ee7ac3682bb27b24fccf954">   70</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a8cb3d1c03ee7ac3682bb27b24fccf954">_verbose</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#ad9bbc220ca70be62ca2684a134afa10f">   71</a></span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html">PolarBackground</a> *<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#ad9bbc220ca70be62ca2684a134afa10f">_master</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a7a64f2b9428457811f3029ba49b4cf78">   72</a></span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EwdInteractor.html">EwdInteractor</a> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a7a64f2b9428457811f3029ba49b4cf78">_ewdactor</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a4edc8e5db51e7e9abd20ef1bf72ebafd">   73</a></span>&#160;        vector&lt;PolarSeg*&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a4edc8e5db51e7e9abd20ef1bf72ebafd">_full_bg_P</a>;</div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a15c7e75444f768096014985d7148fc85">   74</a></span>&#160;        vector&lt;PolarSeg*&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a15c7e75444f768096014985d7148fc85">_part_bg_P</a>;</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a9f4ce4f771c4a7e025a1edd850f66b8f">   75</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a9f4ce4f771c4a7e025a1edd850f66b8f">_not_converged_count</a>;</div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#abd94f31302defa44d8ee141bf184e5db">   76</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#abd94f31302defa44d8ee141bf184e5db">_avg_R_co</a>;</div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a287fadd976b602a542d3c5a506fe7ce0">   77</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1FUThread.html#a287fadd976b602a542d3c5a506fe7ce0">_do_setup_nbs</a>;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    };</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    </div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html">   80</a></span>&#160;    <span class="keyword">class </span><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html">RThread</a> : <span class="keyword">public</span> <a class="code" href="classvotca_1_1ctp_1_1QMThread.html">QMThread</a></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a11da4b0f2f8139a0a1730b5e5dd016a9">   83</a></span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a11da4b0f2f8139a0a1730b5e5dd016a9">RThread</a>(<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html">PolarBackground</a> *master, <span class="keywordtype">bool</span> do_setup_nbs) {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a71b42ef9d4e73c3abf6404aceea25493">_master</a> = master;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a865ae43815ab99e68926adc82182e51f">_do_setup_nbs</a> = do_setup_nbs;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a6faa754cd69f841715400f4e7fbe1642">_not_converged_count</a> = 0;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a007a99a24a1a62408989bf057e00e6b6">_ewdactor</a> = <a class="code" href="classvotca_1_1ctp_1_1EwdInteractor.html">EwdInteractor</a>(<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a71b42ef9d4e73c3abf6404aceea25493">_master</a>-&gt;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a7dfd1ca2e11e1b3df1adbfe77743b19a">_alpha</a>, <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a71b42ef9d4e73c3abf6404aceea25493">_master</a>-&gt;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a44768d8552fa96db634fc4f3abee7d4c">_polar_aDamp</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a635e4cc9687e2e3bc37fd820b7f69ae7">_mode_startfunct</a>[<span class="stringliteral">&quot;FP_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a804dba49c67363ca0d8af14c7371410c">RThread::FP_FieldCalc</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a635e4cc9687e2e3bc37fd820b7f69ae7">_mode_startfunct</a>[<span class="stringliteral">&quot;FU_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a14b856dc005c3d73adff3eaf64c12193">RThread::FU_FieldCalc</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a769bada7b98e72493f3f6db5ab66ff7e">_mode_resetfunct</a>[<span class="stringliteral">&quot;FP_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#add511f61a009b579a75a738324dcd5bd">RThread::FX_FieldReset</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a769bada7b98e72493f3f6db5ab66ff7e">_mode_resetfunct</a>[<span class="stringliteral">&quot;FU_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#add511f61a009b579a75a738324dcd5bd">RThread::FX_FieldReset</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;            </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#ae45887b4e810d5e529b24a6e5bfd88de">_mode_wloadfunct</a>[<span class="stringliteral">&quot;FP_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#afb44044f62d2c6e697d651df13edc4ea">RThread::FX_FieldWload</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#ae45887b4e810d5e529b24a6e5bfd88de">_mode_wloadfunct</a>[<span class="stringliteral">&quot;FU_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#afb44044f62d2c6e697d651df13edc4ea">RThread::FX_FieldWload</a>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        }</div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#ad358aa320b8bca1f18c82b827b6a83b7">   98</a></span>&#160;       <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#ad358aa320b8bca1f18c82b827b6a83b7">~RThread</a>() {</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;           <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#ab4b7a61fe2a600481606a2ff4beb7308">_full_bg_P</a>.clear(); <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#adf6a71352ca475c6001d7bac6062a65a">_part_bg_P</a>.clear();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        }</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;       </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="comment">// Standard multi-mode thread interface</span></div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#aad59ed96d62cc8c6b8aa684c23ba2993">  103</a></span>&#160;        <span class="keyword">typedef</span> void (<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html">RThread</a>::*<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#aad59ed96d62cc8c6b8aa684c23ba2993">StartFunct</a>)();</div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#aa2e3a516cacfa1667229cc301e3f7424">  104</a></span>&#160;        <span class="keyword">typedef</span> void (<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html">RThread</a>::*<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#aa2e3a516cacfa1667229cc301e3f7424">ResetFunct</a>)();</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#af9435344b6a4c06d2550cdffbf9828f2">  105</a></span>&#160;        <span class="keyword">typedef</span> double (<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html">RThread</a>::*<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#af9435344b6a4c06d2550cdffbf9828f2">WloadFunct</a>)();</div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a5dc3d7f06ffcbe326799b7675969e0e4">  106</a></span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html">RThread</a> *<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a5dc3d7f06ffcbe326799b7675969e0e4">Clone</a>() { <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a11da4b0f2f8139a0a1730b5e5dd016a9">RThread</a>(<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a71b42ef9d4e73c3abf6404aceea25493">_master</a>, <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a865ae43815ab99e68926adc82182e51f">_do_setup_nbs</a>); }</div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a3a888547d11e45d2935daf0fcf8513a6">  107</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a3a888547d11e45d2935daf0fcf8513a6">getMode</a>() { <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a407193cd6db38b58f1e27dfeeee8e59a">_current_mode</a>; }</div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a984345b6a18332f261ece686a6f3f784">  108</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a984345b6a18332f261ece686a6f3f784">setMode</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;mode) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a407193cd6db38b58f1e27dfeeee8e59a">_current_mode</a> = mode; }</div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a10bb66f650eacbeaada567b471eb07c0">  109</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a10bb66f650eacbeaada567b471eb07c0">setVerbose</a>(<span class="keywordtype">bool</span> <a class="code" href="namespacevotca_1_1kmc.html#afd736ca1555be72949a4a3cffce1b235">verbose</a>) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a0c9be5cc6e7148c4229c27c5cbc0fac3">_verbose</a> = <a class="code" href="namespacevotca_1_1kmc.html#afd736ca1555be72949a4a3cffce1b235">verbose</a>; }        </div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#af7a196f06c2f4842210f0783337e37bb">  110</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#af7a196f06c2f4842210f0783337e37bb" title="Run() executes the actual code. Overload it.">Run</a>(<span class="keywordtype">void</span>) { </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#aad59ed96d62cc8c6b8aa684c23ba2993">StartFunct</a> start = <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a635e4cc9687e2e3bc37fd820b7f69ae7">_mode_startfunct</a>[<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a407193cd6db38b58f1e27dfeeee8e59a">_current_mode</a>]; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;            ((*this).*start)(); </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        }</div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a68bd00b084461da8a4a2995cf9cfe14e">  114</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a68bd00b084461da8a4a2995cf9cfe14e">Reset</a>(<span class="keywordtype">string</span> mode) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#aa2e3a516cacfa1667229cc301e3f7424">ResetFunct</a> reset = <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a769bada7b98e72493f3f6db5ab66ff7e">_mode_resetfunct</a>[mode];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            ((*this).*reset)();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        }</div>
<div class="line"><a name="l00118"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a31a685a193a76a3492cf96492b6ac7fb">  118</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a31a685a193a76a3492cf96492b6ac7fb">Workload</a>(<span class="keywordtype">string</span> mode) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#af9435344b6a4c06d2550cdffbf9828f2">WloadFunct</a> wload = <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#ae45887b4e810d5e529b24a6e5bfd88de">_mode_wloadfunct</a>[mode];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            <span class="keywordflow">return</span> ((*this).*wload)();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="comment">// Input</span></div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#ac6681d1de96bc8185ad597424fc332e5">  124</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#ac6681d1de96bc8185ad597424fc332e5">AddSharedInput</a>(vector&lt;PolarSeg*&gt; &amp;full_bg_P) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#ab4b7a61fe2a600481606a2ff4beb7308">_full_bg_P</a> = full_bg_P; }</div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a5e32b9fc52e03105ad6d1c48baa938d0">  125</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a5e32b9fc52e03105ad6d1c48baa938d0">AddAtomicInput</a>(<a class="code" href="classvotca_1_1ctp_1_1PolarSeg.html">PolarSeg</a> *pseg) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#adf6a71352ca475c6001d7bac6062a65a">_part_bg_P</a>.push_back(pseg); }</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="comment">// Mode targets</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a14b856dc005c3d73adff3eaf64c12193">FU_FieldCalc</a>();</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a804dba49c67363ca0d8af14c7371410c">FP_FieldCalc</a>();</div>
<div class="line"><a name="l00130"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#add511f61a009b579a75a738324dcd5bd">  130</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#add511f61a009b579a75a738324dcd5bd">FX_FieldReset</a>() { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a6faa754cd69f841715400f4e7fbe1642">_not_converged_count</a> = 0; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#adf6a71352ca475c6001d7bac6062a65a">_part_bg_P</a>.clear(); }</div>
<div class="line"><a name="l00131"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#afb44044f62d2c6e697d651df13edc4ea">  131</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#afb44044f62d2c6e697d651df13edc4ea">FX_FieldWload</a>() { <span class="keywordflow">return</span> 100.*<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#adf6a71352ca475c6001d7bac6062a65a">_part_bg_P</a>.size()/<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#ab4b7a61fe2a600481606a2ff4beb7308">_full_bg_P</a>.size(); }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="comment">// Convergence &amp; output related</span></div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a1f9f470485c205e0bfe1d9966c4f8623">  134</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a1f9f470485c205e0bfe1d9966c4f8623">NotConverged</a>() { <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a6faa754cd69f841715400f4e7fbe1642">_not_converged_count</a>; }</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#adaa4b9ac579ae35d909aecd00765d2ff">  135</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#adaa4b9ac579ae35d909aecd00765d2ff">AvgRco</a>() { <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#aa5725bb0db9d4b1ee4dbd29135dd3976">_avg_R_co</a>; }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="comment">// Multi-mode thread members</span></div>
<div class="line"><a name="l00139"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a0c9be5cc6e7148c4229c27c5cbc0fac3">  139</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a0c9be5cc6e7148c4229c27c5cbc0fac3">_verbose</a>;</div>
<div class="line"><a name="l00140"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a407193cd6db38b58f1e27dfeeee8e59a">  140</a></span>&#160;        <span class="keywordtype">string</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a407193cd6db38b58f1e27dfeeee8e59a">_current_mode</a>;</div>
<div class="line"><a name="l00141"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a635e4cc9687e2e3bc37fd820b7f69ae7">  141</a></span>&#160;        map&lt;string,StartFunct&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a635e4cc9687e2e3bc37fd820b7f69ae7">_mode_startfunct</a>;</div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a769bada7b98e72493f3f6db5ab66ff7e">  142</a></span>&#160;        map&lt;string,ResetFunct&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a769bada7b98e72493f3f6db5ab66ff7e">_mode_resetfunct</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#ae45887b4e810d5e529b24a6e5bfd88de">  143</a></span>&#160;        map&lt;string,WloadFunct&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#ae45887b4e810d5e529b24a6e5bfd88de">_mode_wloadfunct</a>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="comment">// Shared thread data</span></div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a71b42ef9d4e73c3abf6404aceea25493">  146</a></span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html">PolarBackground</a> *<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a71b42ef9d4e73c3abf6404aceea25493">_master</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#ab4b7a61fe2a600481606a2ff4beb7308">  147</a></span>&#160;        vector&lt;PolarSeg*&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#ab4b7a61fe2a600481606a2ff4beb7308">_full_bg_P</a>;        </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="comment">// Atomized thread data</span></div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a007a99a24a1a62408989bf057e00e6b6">  149</a></span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EwdInteractor.html">EwdInteractor</a> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a007a99a24a1a62408989bf057e00e6b6">_ewdactor</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#adf6a71352ca475c6001d7bac6062a65a">  150</a></span>&#160;        vector&lt;PolarSeg*&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#adf6a71352ca475c6001d7bac6062a65a">_part_bg_P</a>;        </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="comment">// Convergence &amp; output-related</span></div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a6faa754cd69f841715400f4e7fbe1642">  152</a></span>&#160;        <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a6faa754cd69f841715400f4e7fbe1642">_not_converged_count</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#aa5725bb0db9d4b1ee4dbd29135dd3976">  153</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#aa5725bb0db9d4b1ee4dbd29135dd3976">_avg_R_co</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a865ae43815ab99e68926adc82182e51f">  154</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1RThread.html#a865ae43815ab99e68926adc82182e51f">_do_setup_nbs</a>;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    };    </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    </div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html">  157</a></span>&#160;    <span class="keyword">class </span><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html">KThread</a> : <span class="keyword">public</span> <a class="code" href="classvotca_1_1ctp_1_1QMThread.html">QMThread</a></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        </div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ac5edaf58146ef6dd5f643ad8c674d407">  161</a></span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ac5edaf58146ef6dd5f643ad8c674d407">KThread</a>(<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html">PolarBackground</a> *master) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a7ee3fe1b6a5077917734113711b6756b">_master</a> = master;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a5562f1b46e1aa636d1da23a13dfa2560">_ewdactor</a> = <a class="code" href="classvotca_1_1ctp_1_1EwdInteractor.html">EwdInteractor</a>(<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a7ee3fe1b6a5077917734113711b6756b">_master</a>-&gt;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a7dfd1ca2e11e1b3df1adbfe77743b19a">_alpha</a>, <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a7ee3fe1b6a5077917734113711b6756b">_master</a>-&gt;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a44768d8552fa96db634fc4f3abee7d4c">_polar_aDamp</a>);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a052cf0186adc0f7c6d02b7bc67405bf2">_mode_startfunct</a>[<span class="stringliteral">&quot;SP_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aecec0b9a8be52d763246652d9357ed0d">KThread::SP_SFactorCalc</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a052cf0186adc0f7c6d02b7bc67405bf2">_mode_startfunct</a>[<span class="stringliteral">&quot;FP_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ac42be1a3cb1964aea706f89ba2707e1d">KThread::FP_KFieldCalc</a>;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a052cf0186adc0f7c6d02b7bc67405bf2">_mode_startfunct</a>[<span class="stringliteral">&quot;SU_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a220d1bbb3b76b82ea1bff296842b8531">KThread::SU_SFactorCalc</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a052cf0186adc0f7c6d02b7bc67405bf2">_mode_startfunct</a>[<span class="stringliteral">&quot;FU_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ae4a83627f46b6ca651e1b6d28b4ceee1">KThread::FU_KFieldCalc</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aabe6c25c569fafc5275885742350c5e3">_mode_resetfunct</a>[<span class="stringliteral">&quot;SP_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ac0e9e1d524ad6f06a329e04f116f925b">KThread::SFactorReset</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aabe6c25c569fafc5275885742350c5e3">_mode_resetfunct</a>[<span class="stringliteral">&quot;FP_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#afe06ab683f02a1078eb856f9450b81ad">KThread::KFieldReset</a>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aabe6c25c569fafc5275885742350c5e3">_mode_resetfunct</a>[<span class="stringliteral">&quot;SU_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ac0e9e1d524ad6f06a329e04f116f925b">KThread::SFactorReset</a>;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aabe6c25c569fafc5275885742350c5e3">_mode_resetfunct</a>[<span class="stringliteral">&quot;FU_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#afe06ab683f02a1078eb856f9450b81ad">KThread::KFieldReset</a>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a0c73dfcdba30b4e0f2ba987a61b5cd09">_mode_wloadfunct</a>[<span class="stringliteral">&quot;SP_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#abd1d6be169b5e117d403d15dad0d648d">KThread::SFactorWload</a>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a0c73dfcdba30b4e0f2ba987a61b5cd09">_mode_wloadfunct</a>[<span class="stringliteral">&quot;FP_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a616df11f0478dec31837fc8ff99f7208">KThread::KFieldWload</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a0c73dfcdba30b4e0f2ba987a61b5cd09">_mode_wloadfunct</a>[<span class="stringliteral">&quot;SU_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#abd1d6be169b5e117d403d15dad0d648d">KThread::SFactorWload</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a0c73dfcdba30b4e0f2ba987a61b5cd09">_mode_wloadfunct</a>[<span class="stringliteral">&quot;FU_MODE&quot;</span>] = &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a616df11f0478dec31837fc8ff99f7208">KThread::KFieldWload</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        }</div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#afc43813f2b2a6388f3668d31b2fe1909">  180</a></span>&#160;       <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#afc43813f2b2a6388f3668d31b2fe1909">~KThread</a>() {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;           <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a8742d0619a9efdc401830795aef62e38">_full_bg_P</a>.clear(); <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a0dba8985ad0fa5c197ca52562f6db294">_full_kvecs</a>.clear(); </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;           <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a7fcc57d0a32868ba0a70194d0abcf7f6">_part_bg_P</a>.clear(); <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aa286296ba1d0839a82638aaee6f86d38">_part_kvecs</a>.clear();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        }</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="comment">// Standard multi-mode thread interface</span></div>
<div class="line"><a name="l00186"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a2e3776f6d0412b167c2d43fe02c5aadc">  186</a></span>&#160;        <span class="keyword">typedef</span> void (<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html">KThread</a>::*<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a2e3776f6d0412b167c2d43fe02c5aadc">StartFunct</a>)();</div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aa378e5a811457e88828e03333e197cc1">  187</a></span>&#160;        <span class="keyword">typedef</span> void (<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html">KThread</a>::*<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aa378e5a811457e88828e03333e197cc1">ResetFunct</a>)();</div>
<div class="line"><a name="l00188"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#acb88de039d9e4e9160c9a60dfab74474">  188</a></span>&#160;        <span class="keyword">typedef</span> double (<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html">KThread</a>::*<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#acb88de039d9e4e9160c9a60dfab74474">WloadFunct</a>)();</div>
<div class="line"><a name="l00189"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a9143cb0fb126aff692a18959b6ec6ab6">  189</a></span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html">KThread</a> *<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a9143cb0fb126aff692a18959b6ec6ab6">Clone</a>() { <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ac5edaf58146ef6dd5f643ad8c674d407">KThread</a>(<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a7ee3fe1b6a5077917734113711b6756b">_master</a>); }</div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#af20908c5c6fe304a521712ae23baa432">  190</a></span>&#160;        <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#af20908c5c6fe304a521712ae23baa432">getMode</a>() { <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ab68889abe2cfbf8d3a58426c4080c7e7">_current_mode</a>; }</div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a4441ec408d980d5fc99b3aa5a237ef0e">  191</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a4441ec408d980d5fc99b3aa5a237ef0e">setMode</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp;mode) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ab68889abe2cfbf8d3a58426c4080c7e7">_current_mode</a> = mode; }</div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aa932c0b51b78fc0d37f18de3d0d2c2ef">  192</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aa932c0b51b78fc0d37f18de3d0d2c2ef">setVerbose</a>(<span class="keywordtype">bool</span> <a class="code" href="namespacevotca_1_1kmc.html#afd736ca1555be72949a4a3cffce1b235">verbose</a>) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a63ffd0491718b521c7c6d94662f25716">_verbose</a> = <a class="code" href="namespacevotca_1_1kmc.html#afd736ca1555be72949a4a3cffce1b235">verbose</a>; }        </div>
<div class="line"><a name="l00193"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#af05d98efa7e09daa66517ddeb2b1d146">  193</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#af05d98efa7e09daa66517ddeb2b1d146" title="Run() executes the actual code. Overload it.">Run</a>(<span class="keywordtype">void</span>) { </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a2e3776f6d0412b167c2d43fe02c5aadc">StartFunct</a> start = <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a052cf0186adc0f7c6d02b7bc67405bf2">_mode_startfunct</a>[<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ab68889abe2cfbf8d3a58426c4080c7e7">_current_mode</a>]; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            ((*this).*start)(); </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div>
<div class="line"><a name="l00197"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a1d903dba74de52b3c9ba2e755b6ffc40">  197</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a1d903dba74de52b3c9ba2e755b6ffc40">Reset</a>(<span class="keywordtype">string</span> mode) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aa378e5a811457e88828e03333e197cc1">ResetFunct</a> reset = <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aabe6c25c569fafc5275885742350c5e3">_mode_resetfunct</a>[mode];</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            ((*this).*reset)();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        }</div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ab6d18f97191f7fb428d149786b127f08">  201</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ab6d18f97191f7fb428d149786b127f08">Workload</a>(<span class="keywordtype">string</span> mode) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#acb88de039d9e4e9160c9a60dfab74474">WloadFunct</a> wload = <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a0c73dfcdba30b4e0f2ba987a61b5cd09">_mode_wloadfunct</a>[mode];</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordflow">return</span> ((*this).*wload)();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        }    </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        </div>
<div class="line"><a name="l00206"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a1e19ef0cbd16e2d55a08e681561d3e78">  206</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a1e19ef0cbd16e2d55a08e681561d3e78">AddSharedInput</a>(vector&lt;EWD::KVector*&gt; &amp;full_kvecs) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a0dba8985ad0fa5c197ca52562f6db294">_full_kvecs</a>.clear(); <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a0dba8985ad0fa5c197ca52562f6db294">_full_kvecs</a> = full_kvecs; }</div>
<div class="line"><a name="l00207"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a73137229efaf473e5832a2daaee4ecc7">  207</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a73137229efaf473e5832a2daaee4ecc7">AddSharedInput</a>(vector&lt;PolarSeg*&gt; &amp;full_bg_P) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a8742d0619a9efdc401830795aef62e38">_full_bg_P</a>.clear(); <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a8742d0619a9efdc401830795aef62e38">_full_bg_P</a> = full_bg_P; }</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="comment">// MODE 1 : Compute structure factor of _part_kvecs using _full_bg_P</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aecec0b9a8be52d763246652d9357ed0d">SP_SFactorCalc</a>();</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a220d1bbb3b76b82ea1bff296842b8531">SU_SFactorCalc</a>();</div>
<div class="line"><a name="l00212"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#abc86004d4c329bcacb15355a1ede2002">  212</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#abc86004d4c329bcacb15355a1ede2002">AddAtomicInput</a>(<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1KVector.html">EWD::KVector</a> *k) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aa286296ba1d0839a82638aaee6f86d38">_part_kvecs</a>.push_back(k); }</div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ac0e9e1d524ad6f06a329e04f116f925b">  213</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ac0e9e1d524ad6f06a329e04f116f925b">SFactorReset</a>() { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aa286296ba1d0839a82638aaee6f86d38">_part_kvecs</a>.clear(); <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a0dba8985ad0fa5c197ca52562f6db294">_full_kvecs</a>.clear(); }</div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#abd1d6be169b5e117d403d15dad0d648d">  214</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#abd1d6be169b5e117d403d15dad0d648d">SFactorWload</a>() { <span class="keywordflow">return</span> (<span class="keywordtype">double</span>)<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aa286296ba1d0839a82638aaee6f86d38">_part_kvecs</a>.size()/<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a0dba8985ad0fa5c197ca52562f6db294">_full_kvecs</a>.size(); }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="comment">// MODE 2 : Increment fields of _part_bg_P using _full_kvecs</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ac42be1a3cb1964aea706f89ba2707e1d">FP_KFieldCalc</a>();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ae4a83627f46b6ca651e1b6d28b4ceee1">FU_KFieldCalc</a>();</div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ad1f6af2db1a67601e7499befdd0625d9">  219</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ad1f6af2db1a67601e7499befdd0625d9">AddAtomicInput</a>(<a class="code" href="classvotca_1_1ctp_1_1PolarSeg.html">PolarSeg</a> *pseg) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a7fcc57d0a32868ba0a70194d0abcf7f6">_part_bg_P</a>.push_back(pseg); }</div>
<div class="line"><a name="l00220"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#afe06ab683f02a1078eb856f9450b81ad">  220</a></span>&#160;        <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#afe06ab683f02a1078eb856f9450b81ad">KFieldReset</a>() { ; }</div>
<div class="line"><a name="l00221"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a616df11f0478dec31837fc8ff99f7208">  221</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a616df11f0478dec31837fc8ff99f7208">KFieldWload</a>() { <span class="keywordflow">return</span> (<span class="keywordtype">double</span>)<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a7fcc57d0a32868ba0a70194d0abcf7f6">_part_bg_P</a>.size()/<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a8742d0619a9efdc401830795aef62e38">_full_bg_P</a>.size(); }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keyword">private</span>:</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="comment">// Multi-mode thread members</span></div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a63ffd0491718b521c7c6d94662f25716">  225</a></span>&#160;        <span class="keywordtype">bool</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a63ffd0491718b521c7c6d94662f25716">_verbose</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ab68889abe2cfbf8d3a58426c4080c7e7">  226</a></span>&#160;        <span class="keywordtype">string</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#ab68889abe2cfbf8d3a58426c4080c7e7">_current_mode</a>;</div>
<div class="line"><a name="l00227"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a052cf0186adc0f7c6d02b7bc67405bf2">  227</a></span>&#160;        map&lt;string,StartFunct&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a052cf0186adc0f7c6d02b7bc67405bf2">_mode_startfunct</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aabe6c25c569fafc5275885742350c5e3">  228</a></span>&#160;        map&lt;string,ResetFunct&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aabe6c25c569fafc5275885742350c5e3">_mode_resetfunct</a>;</div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a0c73dfcdba30b4e0f2ba987a61b5cd09">  229</a></span>&#160;        map&lt;string,WloadFunct&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a0c73dfcdba30b4e0f2ba987a61b5cd09">_mode_wloadfunct</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        <span class="comment">// Shared thread data</span></div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a7ee3fe1b6a5077917734113711b6756b">  232</a></span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html">PolarBackground</a> *<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a7ee3fe1b6a5077917734113711b6756b">_master</a>;</div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a8742d0619a9efdc401830795aef62e38">  233</a></span>&#160;        vector&lt;PolarSeg*&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a8742d0619a9efdc401830795aef62e38">_full_bg_P</a>;</div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a0dba8985ad0fa5c197ca52562f6db294">  234</a></span>&#160;        vector&lt;EWD::KVector*&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a0dba8985ad0fa5c197ca52562f6db294">_full_kvecs</a>;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="comment">// Atomized thread data</span></div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a5562f1b46e1aa636d1da23a13dfa2560">  237</a></span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EwdInteractor.html">EwdInteractor</a> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a5562f1b46e1aa636d1da23a13dfa2560">_ewdactor</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aa286296ba1d0839a82638aaee6f86d38">  238</a></span>&#160;        vector&lt;EWD::KVector*&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aa286296ba1d0839a82638aaee6f86d38">_part_kvecs</a>;</div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a7fcc57d0a32868ba0a70194d0abcf7f6">  239</a></span>&#160;        vector&lt;PolarSeg*&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a7fcc57d0a32868ba0a70194d0abcf7f6">_part_bg_P</a>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keyword">public</span>:</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="comment">// Convergence info</span></div>
<div class="line"><a name="l00243"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a1f2cec8b8d68fc69ee69e0da846fc6db">  243</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#a1f2cec8b8d68fc69ee69e0da846fc6db">_rms_sum_re</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aba58096ef55ea8e7b80742ff3f161dd1">  244</a></span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground_1_1KThread.html#aba58096ef55ea8e7b80742ff3f161dd1">_sum_im</a>;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    };</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div>
<div class="line"><a name="l00250"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#af2bd97aaebd164a8a7e5c367c4890b9e">  250</a></span>&#160;    <a class="code" href="classvotca_1_1ctp_1_1EwdInteractor.html">EwdInteractor</a> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#af2bd97aaebd164a8a7e5c367c4890b9e">_ewdactor</a>;</div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a36a2559ea43333c1411f8b70e81a34da">  251</a></span>&#160;    <a class="code" href="classvotca_1_1ctp_1_1Logger.html" title="Logger is used for thread-safe output of messages.">Logger</a> *<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a36a2559ea43333c1411f8b70e81a34da">_log</a>;</div>
<div class="line"><a name="l00252"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#affa5247fe99710053b15e045b2bc207b">  252</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#affa5247fe99710053b15e045b2bc207b">_n_threads</a>;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// PERIODIC BOUNDARY</span></div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a420d6cbf02042750e5b918965ac3df7c">  255</a></span>&#160;    <a class="code" href="classvotca_1_1ctp_1_1Topology.html" title="Container for molecules, conjugated segments, rigid fragments, and atoms.">Topology</a> *<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a420d6cbf02042750e5b918965ac3df7c">_top</a>;</div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a662d5a41ef510b60f17f0193c37f1b72">  256</a></span>&#160;    <span class="keywordtype">string</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a662d5a41ef510b60f17f0193c37f1b72">_shape</a>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// POLAR SEGMENTS</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">// Part I - Ewald</span></div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#aca97110013daeb48cfaf5de65f84ef7f">  260</a></span>&#160;    <a class="code" href="classvotca_1_1ctp_1_1PolarTop.html">PolarTop</a> *<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#aca97110013daeb48cfaf5de65f84ef7f">_ptop</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a38457e7af480d4ae3d80e6c94ab507d1">  261</a></span>&#160;    vector&lt; PolarSeg* &gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a38457e7af480d4ae3d80e6c94ab507d1">_bg_P</a>;      <span class="comment">// Period. density = _bg_N v _fg_N</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// CONVERGENCE</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// Part I - Ewald</span></div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a7dfd1ca2e11e1b3df1adbfe77743b19a">  265</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a7dfd1ca2e11e1b3df1adbfe77743b19a">_alpha</a>;                  <span class="comment">// _a = 1/(sqrt(2)*sigma)</span></div>
<div class="line"><a name="l00266"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a5e600828fda9aa5a7673dc0c4bcf8121">  266</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a5e600828fda9aa5a7673dc0c4bcf8121">_kfactor</a>;</div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#ae7a7f591b8bf03ee56e881fba0486e77">  267</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#ae7a7f591b8bf03ee56e881fba0486e77">_rfactor</a>;</div>
<div class="line"><a name="l00268"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a506611c6626e7a87658ceda30d5c87fa">  268</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a506611c6626e7a87658ceda30d5c87fa">_K_co</a>;                   <span class="comment">// k-space c/o</span></div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a5c0f0e87f7d4962f4c68ac464974e537">  269</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a5c0f0e87f7d4962f4c68ac464974e537">_R_co</a>;                   <span class="comment">// r-space c/o</span></div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#afa29bc22dc59c5b1f37f5b80c8da5cca">  270</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#afa29bc22dc59c5b1f37f5b80c8da5cca">_crit_dE</a>;                <span class="comment">// Energy convergence criterion [eV]</span></div>
<div class="line"><a name="l00271"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a93c874de6b2d6c330855692ac2d90603">  271</a></span>&#160;    <span class="keywordtype">bool</span>   <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a93c874de6b2d6c330855692ac2d90603">_converged_R</a>;            <span class="comment">// Did R-space sum converge?</span></div>
<div class="line"><a name="l00272"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#ae56071ea6212b5f4c58299313fbd25eb">  272</a></span>&#160;    <span class="keywordtype">bool</span>   <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#ae56071ea6212b5f4c58299313fbd25eb">_converged_K</a>;            <span class="comment">// Did K-space sum converge?</span></div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a15eeff06063c9d4a04b81c993712264f">  273</a></span>&#160;    <span class="keywordtype">bool</span>   <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a15eeff06063c9d4a04b81c993712264f">_field_converged_R</a>;</div>
<div class="line"><a name="l00274"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a8d7e5a40ba9107da2e13293ea25655f1">  274</a></span>&#160;    <span class="keywordtype">bool</span>   <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a8d7e5a40ba9107da2e13293ea25655f1">_field_converged_K</a>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="comment">// Part II - Thole</span></div>
<div class="line"><a name="l00276"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a44768d8552fa96db634fc4f3abee7d4c">  276</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a44768d8552fa96db634fc4f3abee7d4c">_polar_aDamp</a>;</div>
<div class="line"><a name="l00277"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a5d55518d4411a0b4577ee8d68e431789">  277</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a5d55518d4411a0b4577ee8d68e431789">_polar_wSOR_N</a>;</div>
<div class="line"><a name="l00278"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a4c9d3f5ff63ddd16da29497aa30b3395">  278</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a4c9d3f5ff63ddd16da29497aa30b3395">_polar_cutoff</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">// LATTICE (REAL, RECIPROCAL)</span></div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#ab0629f23696e3b41b2e3dbaa89a92c4a">  281</a></span>&#160;    <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a1f29e337a8116237478a3ccfc93e9706">_a</a>; <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#ae64b7a443c3e37f1e9af39043e71b1bc">_b</a>; <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#ab0629f23696e3b41b2e3dbaa89a92c4a">_c</a>;         <span class="comment">// Real-space lattice vectors</span></div>
<div class="line"><a name="l00282"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a15f73939f3a2c749bb08ba4ffadf129c">  282</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a31b5e4b1700ac35ede6637c70ce56457">_na_max</a>, <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a1f52f0c1e1197eb63462b248bc4d5bb1">_nb_max</a>, <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a15f73939f3a2c749bb08ba4ffadf129c">_nc_max</a>;  <span class="comment">// Max. cell indices to sum over (R)</span></div>
<div class="line"><a name="l00283"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#af995864563242bb747f4b03503dab867">  283</a></span>&#160;    <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#aaaab4d8323f20a9e9937a2df0567730a">_A</a>; <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a468dd0ccd1efb66ee8a8b9367dda4a8b">_B</a>; <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#af995864563242bb747f4b03503dab867">_C</a>;         <span class="comment">// Reciprocal-space lattice vectors</span></div>
<div class="line"><a name="l00284"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a5467a0042ac18e2acf1e828d71d7641d">  284</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#adf61d2e80344036594d535d500ce2653">_NA_max</a>, <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a7548d6604cdd998b3cb9e78e167f39c7">_NB_max</a>, <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a5467a0042ac18e2acf1e828d71d7641d">_NC_max</a>;  <span class="comment">// Max. cell indices to sum over (K)</span></div>
<div class="line"><a name="l00285"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a181b80d3d980e5a957977511b006d1d8">  285</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a181b80d3d980e5a957977511b006d1d8">_LxLy</a>;                   <span class="comment">// |a^b|</span></div>
<div class="line"><a name="l00286"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a905410ace54ae78e2a64004bd056e3ca">  286</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a905410ace54ae78e2a64004bd056e3ca">_LxLyLz</a>;                 <span class="comment">// a*|b^c|</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div>
<div class="line"><a name="l00288"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#aeedeb1939e8992903464cfe16c19e973">  288</a></span>&#160;    <a class="code" href="structvotca_1_1ctp_1_1EWD_1_1VectorSort.html">EWD::VectorSort&lt;EWD::MaxNorm,vec&gt;</a> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#aeedeb1939e8992903464cfe16c19e973">_maxsort</a>;</div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a2487c96b25b912958130d8885b44e12e">  289</a></span>&#160;    <a class="code" href="structvotca_1_1ctp_1_1EWD_1_1VectorSort.html">EWD::VectorSort&lt;EWD::EucNorm,vec&gt;</a> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a2487c96b25b912958130d8885b44e12e">_eucsort</a>;</div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#ad42821a4eef3f5e23125a86c2b39ac60">  290</a></span>&#160;    <a class="code" href="structvotca_1_1ctp_1_1EWD_1_1VectorSort.html">EWD::VectorSort&lt;EWD::KNorm,EWD::KVector&gt;</a> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#ad42821a4eef3f5e23125a86c2b39ac60">_kvecsort</a>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a7cb003f6defb93b9e878db4f81b4ac3a">  292</a></span>&#160;    vector&lt;EWD::KVector*&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#a7cb003f6defb93b9e878db4f81b4ac3a">_kvecs_2_0</a>;   <span class="comment">// K-vectors with two components = zero</span></div>
<div class="line"><a name="l00293"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#afbc48e2fb279f4b66b56f236797bb6ca">  293</a></span>&#160;    vector&lt;EWD::KVector*&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#afbc48e2fb279f4b66b56f236797bb6ca">_kvecs_1_0</a>;   <span class="comment">// K-vectors with one component  = zero</span></div>
<div class="line"><a name="l00294"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#aa75b4d0d7322e3a6baf0ef8df006c482">  294</a></span>&#160;    vector&lt;EWD::KVector*&gt; <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#aa75b4d0d7322e3a6baf0ef8df006c482">_kvecs_0_0</a>;   <span class="comment">// K-vectors with no  components = zero</span></div>
<div class="line"><a name="l00295"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#ada8fdf1c9b849bdfd45020f9eac54019">  295</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PolarBackground.html#ada8fdf1c9b849bdfd45020f9eac54019">_kxyz_s1s2_norm</a>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;};</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="keyword">template</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;&lt;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">// REQUIRED Clone()</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">// OPTIONAL </span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keyword">typename</span> T</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;&gt;</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html">  306</a></span>&#160;<span class="keyword">class </span><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html">PrototypeCreator</a></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;{</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00309"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html#aece4a27a6210030ccee4574a76b0875a">  309</a></span>&#160;    <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html#aece4a27a6210030ccee4574a76b0875a">PrototypeCreator</a>(T *prototype=0) : <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html#a345597b44e162fad2789b271f0b681ea">_prototype</a>(prototype) {}</div>
<div class="line"><a name="l00310"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html#ad6746b4ffb7285f40e55cb6e5f9420d7">  310</a></span>&#160;    T *<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html#ad6746b4ffb7285f40e55cb6e5f9420d7">Create</a>() { <span class="keywordflow">return</span> (<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html#a345597b44e162fad2789b271f0b681ea">_prototype</a>) ? <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html#a345597b44e162fad2789b271f0b681ea">_prototype</a>-&gt;Clone() : 0; }</div>
<div class="line"><a name="l00311"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html#ab7c4a14f9f9929db4d879a050a02a884">  311</a></span>&#160;    T *<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html#ab7c4a14f9f9929db4d879a050a02a884">getPrototype</a>() { <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html#a345597b44e162fad2789b271f0b681ea">_prototype</a>; }</div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html#ac6b19538b95b47197b8052ccb0c3f4e0">  312</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html#ac6b19538b95b47197b8052ccb0c3f4e0">setPrototype</a>(T *prototype) { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html#a345597b44e162fad2789b271f0b681ea">_prototype</a> = prototype; }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00314"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html#a345597b44e162fad2789b271f0b681ea">  314</a></span>&#160;    T *<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1PrototypeCreator.html#a345597b44e162fad2789b271f0b681ea">_prototype</a>;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;};</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keyword">template</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;&lt;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// REQUIRED setId(int), Start, WaitDone</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// OPTIONAL setMode(&lt;&gt;), setVerbose(bool), AddAtomicInput(&lt;&gt;), AddSharedInput(&lt;&gt;)</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keyword">typename</span> ThreadType,</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// REQUIRED Create</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// OPTIONAL</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span>&gt; <span class="keyword">class </span>CreatorType</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;&gt;</div>
<div class="line"><a name="l00327"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html">  327</a></span>&#160;<span class="keyword">class </span><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html">ThreadForce</a> : </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keyword">public</span> vector&lt;ThreadType*&gt;, </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keyword">public</span> CreatorType&lt;ThreadType&gt;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;{</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#ab83fb57b902cc4af81c7320311759d0d">  332</a></span>&#160;    <span class="keyword">typedef</span> <span class="keyword">typename</span> ThreadForce::iterator <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#ab83fb57b902cc4af81c7320311759d0d">it_t</a>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    </div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#a1a51734d9e4e93aca570223708f662a9">  334</a></span>&#160;    <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#a1a51734d9e4e93aca570223708f662a9">ThreadForce</a>() {}</div>
<div class="line"><a name="l00335"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#a00091d791428b9986e4e2edf47a6b428">  335</a></span>&#160;   <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#a00091d791428b9986e4e2edf47a6b428">~ThreadForce</a>() { <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#a789ec4b0a8e3134df758d129e9614e7b">Disband</a>(); }</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    </div>
<div class="line"><a name="l00337"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#ab07fca9a71d09cd84fd212a68b07b269">  337</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#ab07fca9a71d09cd84fd212a68b07b269">Initialize</a>(<span class="keywordtype">int</span> n_threads) {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="comment">// Set-up threads via CreatorType policy</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t = 0; t &lt; n_threads; ++t) {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            ThreadType *new_thread = this-&gt;Create();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            new_thread-&gt;setId(this-&gt;size()+1);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            this-&gt;push_back(new_thread);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        }</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    }</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">typename</span> mode_t&gt;</div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#a1f43f0693e9b0fd3fb1d576880eea66a">  348</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#a1f43f0693e9b0fd3fb1d576880eea66a">AssignMode</a>(mode_t mode) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">// Set mode</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#ab83fb57b902cc4af81c7320311759d0d">it_t</a> tfit;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">for</span> (tfit = this-&gt;begin(); tfit &lt; this-&gt;end(); ++tfit)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;           (*tfit)-&gt;setMode(mode);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">class</span> in_t&gt;</div>
<div class="line"><a name="l00357"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#a9486f65db662acfd7f8477d0fe8c156e">  357</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#a9486f65db662acfd7f8477d0fe8c156e">AddAtomicInput</a>(vector&lt;in_t&gt; &amp;inputs) {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="comment">// Apportion the vector elements equally onto all threads</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keyword">typename</span> vector&lt;in_t&gt;::iterator iit;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordtype">int</span> in_idx = 0;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordtype">int</span> th_idx = 0;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">for</span> (iit = inputs.begin(); iit != inputs.end(); ++iit, ++in_idx) {</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordtype">int</span> th_idx = in_idx % this-&gt;size();</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            (*this)[th_idx]-&gt;AddAtomicInput(*iit);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="comment">// The thread with the last input can be verbose</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#ab83fb57b902cc4af81c7320311759d0d">it_t</a> tfit = this-&gt;begin(); tfit &lt; this-&gt;end(); ++tfit)</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            (*tfit)-&gt;setVerbose(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        (*this)[th_idx]-&gt;setVerbose(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">class</span> in_t&gt;</div>
<div class="line"><a name="l00374"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#a23c380390521d092c50d7e6757571f0b">  374</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#a23c380390521d092c50d7e6757571f0b">AddSharedInput</a>(in_t &amp;shared_input) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#ab83fb57b902cc4af81c7320311759d0d">it_t</a> tfit = this-&gt;begin(); tfit &lt; this-&gt;end(); ++tfit)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            (*tfit)-&gt;AddSharedInput(shared_input);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    </div>
<div class="line"><a name="l00380"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#ac6f2f2d986e892381d4513f31fb6b8d3">  380</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#ac6f2f2d986e892381d4513f31fb6b8d3">StartAndWait</a>() {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="comment">// Start threads</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#ab83fb57b902cc4af81c7320311759d0d">it_t</a> tfit = this-&gt;begin(); tfit &lt; this-&gt;end(); ++tfit)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            (*tfit)-&gt;Start();</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="comment">// Wait for threads</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#ab83fb57b902cc4af81c7320311759d0d">it_t</a> tfit = this-&gt;begin(); tfit &lt; this-&gt;end(); ++tfit)</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            (*tfit)-&gt;WaitDone();</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keyword">template</span>&lt;<span class="keyword">class</span> mode_t&gt;</div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#abad29259eec9d6f1ef6a2a3cee54a41d">  391</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#abad29259eec9d6f1ef6a2a3cee54a41d">Reset</a>(mode_t mode) {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">for</span> (<a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#ab83fb57b902cc4af81c7320311759d0d">it_t</a> tfit = this-&gt;begin(); tfit &lt; this-&gt;end(); ++tfit)</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            (*tfit)-&gt;Reset(mode);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    </div>
<div class="line"><a name="l00397"></a><span class="lineno"><a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#a789ec4b0a8e3134df758d129e9614e7b">  397</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#a789ec4b0a8e3134df758d129e9614e7b">Disband</a>() {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="comment">// Delete &amp; clear</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <a class="code" href="classvotca_1_1ctp_1_1EWD_1_1ThreadForce.html#ab83fb57b902cc4af81c7320311759d0d">it_t</a> tfit;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">for</span> (tfit = this-&gt;begin(); tfit &lt; this-&gt;end(); ++tfit)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="keyword">delete</span> *tfit;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        this-&gt;clear();</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;};</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;}</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;}}</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
