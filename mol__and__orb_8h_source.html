<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Votca: moo/include/votca/moo/mol_and_orb.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
<h1>moo/include/votca/moo/mol_and_orb.h</h1><a href="mol__and__orb_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright 2009-2011 The VOTCA Development Team (http://www.votca.org)</span>
<a name="l00003"></a>00003 <span class="comment"> *</span>
<a name="l00004"></a>00004 <span class="comment"> * Licensed under the Apache License, Version 2.0 (the "License");</span>
<a name="l00005"></a>00005 <span class="comment"> * you may not use this file except in compliance with the License.</span>
<a name="l00006"></a>00006 <span class="comment"> * You may obtain a copy of the License at</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> *     http://www.apache.org/licenses/LICENSE-2.0</span>
<a name="l00009"></a>00009 <span class="comment"> *</span>
<a name="l00010"></a>00010 <span class="comment"> * Unless required by applicable law or agreed to in writing, software</span>
<a name="l00011"></a>00011 <span class="comment"> * distributed under the License is distributed on an "AS IS" BASIS,</span>
<a name="l00012"></a>00012 <span class="comment"> * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<a name="l00013"></a>00013 <span class="comment"> * See the License for the specific language governing permissions and</span>
<a name="l00014"></a>00014 <span class="comment"> * limitations under the License.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> */</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#ifndef FILE_MOLECULES_EL</span>
<a name="l00019"></a>00019 <span class="preprocessor"></span><span class="preprocessor">#define FILE_MOLECULES_EL</span>
<a name="l00020"></a>00020 <span class="preprocessor"></span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00022"></a>00022 <span class="preprocessor">#include &lt;fstream&gt;</span>
<a name="l00023"></a>00023 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00024"></a>00024 <span class="preprocessor">#include &lt;iomanip&gt;</span> 
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00027"></a>00027 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00028"></a>00028 <span class="preprocessor">#include "<a class="code" href="orbitals_8h.html">orbitals.h</a>"</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include "<a class="code" href="basis__set_8h.html">basis_set.h</a>"</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include "<a class="code" href="charges_8h.html">charges.h</a>"</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include "<a class="code" href="global_8h.html">global.h</a>"</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include "<a class="code" href="units_8h.html">units.h</a>"</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include &lt;<a class="code" href="vec_8h.html">votca/tools/vec.h</a>&gt;</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;<a class="code" href="globals_8h.html">votca/tools/globals.h</a>&gt;</span>
<a name="l00035"></a>00035 
<a name="l00037"></a>00037 <span class="keyword">namespace </span>votca { <span class="keyword">namespace </span>moo {
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="keyword">using namespace </span>std;
<a name="l00040"></a>00040 
<a name="l00041"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html">00041</a> <span class="keyword">class </span><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html">mol_and_orb</a>
<a name="l00042"></a>00042 {
<a name="l00043"></a>00043 <span class="keyword">private</span>:
<a name="l00044"></a>00044 
<a name="l00045"></a><a class="code" href="structvotca_1_1moo_1_1mol__and__orb_1_1atom__type.html">00045</a>     <span class="keyword">struct </span><a class="code" href="structvotca_1_1moo_1_1mol__and__orb_1_1atom__type.html">atom_type</a> {
<a name="l00046"></a><a class="code" href="structvotca_1_1moo_1_1mol__and__orb_1_1atom__type.html#1e1b807b9035b394e0918ea3f9819175">00046</a>         <span class="keywordtype">string</span> <a class="code" href="structvotca_1_1moo_1_1mol__and__orb_1_1atom__type.html#1e1b807b9035b394e0918ea3f9819175">_type</a>;
<a name="l00047"></a><a class="code" href="structvotca_1_1moo_1_1mol__and__orb_1_1atom__type.html#72d87835b106d0831148b887716931ac">00047</a>         <span class="keywordtype">int</span> <a class="code" href="structvotca_1_1moo_1_1mol__and__orb_1_1atom__type.html#72d87835b106d0831148b887716931ac">_lbl</a>;
<a name="l00048"></a>00048     };   
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#351ed37b65dd1a0fca3fb5254ef29d4d">00050</a>     vector &lt;atom_type&gt; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#351ed37b65dd1a0fca3fb5254ef29d4d">atom_labels</a> ; <span class="comment">// label of atoms</span>
<a name="l00051"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">00051</a>     vector &lt;vec&gt;       <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>;
<a name="l00052"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#9065c6a11cf79db77d3649cf21098ee7">00052</a>     <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#9065c6a11cf79db77d3649cf21098ee7">N</a>; <span class="comment">// the number of atoms in the molecule</span>
<a name="l00053"></a>00053 
<a name="l00054"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#d6dbd7ed1aa3097f1760f3d899905241">00054</a>     <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#d6dbd7ed1aa3097f1760f3d899905241">centre</a>;
<a name="l00055"></a>00055 
<a name="l00056"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#bf2006b07fecfd7f0f23439181615b8b">00056</a>     <a class="code" href="classvotca_1_1moo_1_1orb.html">orb</a> *<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#bf2006b07fecfd7f0f23439181615b8b">orbitals</a>;
<a name="l00057"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3551bba4142c3b4a50fb63b6b8adf737">00057</a>     <a class="code" href="classvotca_1_1moo_1_1multipoles.html">multipoles</a> *<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3551bba4142c3b4a50fb63b6b8adf737">_crged</a>;
<a name="l00058"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#753faff13c5b08d640f272ac0d395be0">00058</a>     <a class="code" href="classvotca_1_1moo_1_1multipoles.html">multipoles</a> *<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#753faff13c5b08d640f272ac0d395be0">_neutr</a>;
<a name="l00059"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#371896629902b6c26c9ac779c7d60a25">00059</a>     <a class="code" href="classvotca_1_1moo_1_1basis__set.html">basis_set</a> *<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#371896629902b6c26c9ac779c7d60a25">_bs</a>;
<a name="l00060"></a>00060 
<a name="l00061"></a>00061 <span class="keyword">public</span>:
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8b60a14a678017f76ec77492d019b6c3">00063</a>     <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8b60a14a678017f76ec77492d019b6c3">n_el</a>;
<a name="l00064"></a>00064 
<a name="l00065"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#7b25abd4d339a00f60924967d6d5d5e3">00065</a>     <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#7b25abd4d339a00f60924967d6d5d5e3">mol_and_orb</a>(): <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#9065c6a11cf79db77d3649cf21098ee7">N</a>(0), <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#bf2006b07fecfd7f0f23439181615b8b">orbitals</a>(0), <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3551bba4142c3b4a50fb63b6b8adf737">_crged</a>(0),
<a name="l00066"></a>00066                    <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#753faff13c5b08d640f272ac0d395be0">_neutr</a>(0), <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#d6dbd7ed1aa3097f1760f3d899905241">centre</a>(0.,0.,0.), <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8b60a14a678017f76ec77492d019b6c3">n_el</a>(0) { }
<a name="l00067"></a>00067 
<a name="l00068"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#dbc9419fb77606c1721e9dcbbee08509">00068</a>    <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#dbc9419fb77606c1721e9dcbbee08509">~mol_and_orb</a>() {
<a name="l00069"></a>00069         <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>.clear();
<a name="l00070"></a>00070         <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#351ed37b65dd1a0fca3fb5254ef29d4d">atom_labels</a>.clear();
<a name="l00071"></a>00071     }
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 
<a name="l00074"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#2c8acb1e0623597ab8a1b1eca2fbea09">00074</a>     <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#2c8acb1e0623597ab8a1b1eca2fbea09">getCentre</a>() { <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#d6dbd7ed1aa3097f1760f3d899905241">centre</a>; }
<a name="l00075"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#42705fd834064584f30e8fce67555d95">00075</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#42705fd834064584f30e8fce67555d95">setCentre</a>(<span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> &amp;pos) { <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#d6dbd7ed1aa3097f1760f3d899905241">centre</a> = pos; }
<a name="l00076"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#498e21af17165adc02cbdc324ef3c757">00076</a>     vector&lt; vec &gt; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#498e21af17165adc02cbdc324ef3c757">getAtomPos</a>() { <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>; }
<a name="l00077"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#ef5527f6af1cc828edd2398a7cf1c640">00077</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#ef5527f6af1cc828edd2398a7cf1c640">setAtomPos</a>(vector&lt; vec &gt; &amp;positions) { <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a> = positions; }
<a name="l00078"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#461b91f14d714248a6a98bb1d9469c83">00078</a>     vector&lt; atom_type &gt; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#461b91f14d714248a6a98bb1d9469c83">getAtomLabels</a>() { <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#351ed37b65dd1a0fca3fb5254ef29d4d">atom_labels</a>; }
<a name="l00079"></a>00079     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#50109799212f9194c4d3efc94d1d62a2">setAtomLabels</a>(vector&lt;string&gt; types, vector&lt;int&gt; labels);
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 
<a name="l00082"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8d8d6e8c144018d1a622117196ebe510">00082</a>     <a class="code" href="classvotca_1_1moo_1_1multipoles.html">multipoles</a> *<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8d8d6e8c144018d1a622117196ebe510">getChargesNeutr</a>() { <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#753faff13c5b08d640f272ac0d395be0">_neutr</a>; }
<a name="l00083"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#c1f3f6fd5c64dfdac174043f6f902e91">00083</a>     <a class="code" href="classvotca_1_1moo_1_1multipoles.html">multipoles</a> *<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#c1f3f6fd5c64dfdac174043f6f902e91">getChargesCrged</a>(){ <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3551bba4142c3b4a50fb63b6b8adf737">_crged</a>; }
<a name="l00084"></a>00084 
<a name="l00085"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#246af928be8d6f164581391df6182c46">00085</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#246af928be8d6f164581391df6182c46">cp_atompos</a>(<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html">mol_and_orb</a> &amp; <a class="code" href="namespacevotca_1_1moo.html#6a44f6663e516c56327f0baf6560f39d9f3d14e2c1203137934a1c1df177808d">A</a>) {
<a name="l00086"></a>00086        <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>.clear();         
<a name="l00087"></a>00087     
<a name="l00088"></a>00088        vector &lt; vec &gt;:: iterator iter_pos;
<a name="l00089"></a>00089        <span class="keywordflow">for</span> (iter_pos=(A.<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>).begin();
<a name="l00090"></a>00090             iter_pos&lt;A.<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>.end();
<a name="l00091"></a>00091             ++iter_pos){
<a name="l00092"></a>00092             <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>.push_back(*iter_pos);
<a name="l00093"></a>00093        }           
<a name="l00094"></a>00094        <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#9065c6a11cf79db77d3649cf21098ee7">N</a> = A.<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#9065c6a11cf79db77d3649cf21098ee7">N</a>;
<a name="l00095"></a>00095     }
<a name="l00096"></a>00096 
<a name="l00097"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#47e96be1f89703166bcb902305d05d56">00097</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#47e96be1f89703166bcb902305d05d56">cp_atoms</a>(<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html">mol_and_orb</a>  &amp; <a class="code" href="namespacevotca_1_1moo.html#6a44f6663e516c56327f0baf6560f39d9f3d14e2c1203137934a1c1df177808d">A</a>) {
<a name="l00098"></a>00098         <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#351ed37b65dd1a0fca3fb5254ef29d4d">atom_labels</a>.clear();     
<a name="l00099"></a>00099 
<a name="l00100"></a>00100         vector &lt; atom_type &gt;:: iterator iter_pos;
<a name="l00101"></a>00101         <span class="keywordflow">for</span> (iter_pos=A.<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#351ed37b65dd1a0fca3fb5254ef29d4d">atom_labels</a>.begin();
<a name="l00102"></a>00102              iter_pos&lt;A.<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#351ed37b65dd1a0fca3fb5254ef29d4d">atom_labels</a>.end();
<a name="l00103"></a>00103              ++iter_pos){
<a name="l00104"></a>00104              <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#351ed37b65dd1a0fca3fb5254ef29d4d">atom_labels</a>.push_back(*iter_pos);
<a name="l00105"></a>00105         }          
<a name="l00106"></a>00106     }
<a name="l00107"></a>00107 
<a name="l00108"></a>00108     <span class="comment">/*void cp_orb( mol_and_orb const &amp; A, vector &lt;int&gt; a ){</span>
<a name="l00109"></a>00109 <span class="comment">        for (unsigned  int i=0 ;i&lt; a.size(); i++){</span>
<a name="l00110"></a>00110 <span class="comment">                orbitals -&gt; cp_orb( *(A.orbitals), a[i]) ; </span>
<a name="l00111"></a>00111 <span class="comment">        }</span>
<a name="l00112"></a>00112 <span class="comment">    }*/</span>
<a name="l00113"></a>00113     
<a name="l00114"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8b59bde65f7ec96316cb5858e015ee9f">00114</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8b59bde65f7ec96316cb5858e015ee9f">cp_orb</a>( <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html">mol_and_orb</a> <span class="keyword">const</span> &amp; <a class="code" href="namespacevotca_1_1moo.html#6a44f6663e516c56327f0baf6560f39d9f3d14e2c1203137934a1c1df177808d">A</a>, vector &lt;unsigned int&gt; <a class="code" href="namespacemerge__orbitals.html#e661cff9a8b946474f1a6fb5280bd474">a</a> ) {
<a name="l00115"></a>00115         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  <span class="keywordtype">int</span> <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>=0 ;<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>&lt; a.size(); <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>++) {
<a name="l00116"></a>00116              <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#bf2006b07fecfd7f0f23439181615b8b">orbitals</a> -&gt; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8b59bde65f7ec96316cb5858e015ee9f">cp_orb</a>( *(A.<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#bf2006b07fecfd7f0f23439181615b8b">orbitals</a>), a[<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>]) ;
<a name="l00117"></a>00117         }
<a name="l00118"></a>00118     }
<a name="l00119"></a>00119 
<a name="l00120"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#9fcd2c48f7e45c216798bbab67e15168">00120</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#9fcd2c48f7e45c216798bbab67e15168">cp_orb</a>( <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html">mol_and_orb</a> <span class="keyword">const</span> &amp; <a class="code" href="namespacevotca_1_1moo.html#6a44f6663e516c56327f0baf6560f39d9f3d14e2c1203137934a1c1df177808d">A</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; <a class="code" href="namespacemerge__orbitals.html#e661cff9a8b946474f1a6fb5280bd474">a</a> ) {
<a name="l00121"></a>00121         <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#bf2006b07fecfd7f0f23439181615b8b">orbitals</a> -&gt; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8b59bde65f7ec96316cb5858e015ee9f">cp_orb</a>( *(A.<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#bf2006b07fecfd7f0f23439181615b8b">orbitals</a>), a);
<a name="l00122"></a>00122     }
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#999b6ca3801a70decc8e38c733f8257b">00124</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#999b6ca3801a70decc8e38c733f8257b">cp_crg</a> ( <span class="keyword">const</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html">mol_and_orb</a> &amp; <a class="code" href="namespacevotca_1_1moo.html#6a44f6663e516c56327f0baf6560f39d9f3d14e2c1203137934a1c1df177808d">A</a> ) {
<a name="l00125"></a>00125         <span class="keywordflow">if</span> (A.<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3551bba4142c3b4a50fb63b6b8adf737">_crged</a> == NULL) <span class="keywordflow">return</span>;
<a name="l00126"></a>00126         <span class="keywordflow">if</span> (A.<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#753faff13c5b08d640f272ac0d395be0">_neutr</a> == NULL) <span class="keywordflow">return</span>;
<a name="l00127"></a>00127         <span class="keywordflow">if</span> (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3551bba4142c3b4a50fb63b6b8adf737">_crged</a> == 0 ) <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3551bba4142c3b4a50fb63b6b8adf737">_crged</a> = <span class="keyword">new</span> <a class="code" href="classvotca_1_1moo_1_1multipoles.html">multipoles</a>;
<a name="l00128"></a>00128         <span class="keywordflow">if</span> (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#753faff13c5b08d640f272ac0d395be0">_neutr</a> == 0 ) <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#753faff13c5b08d640f272ac0d395be0">_neutr</a> = <span class="keyword">new</span> <a class="code" href="classvotca_1_1moo_1_1multipoles.html">multipoles</a>;
<a name="l00129"></a>00129         
<a name="l00130"></a>00130         <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3551bba4142c3b4a50fb63b6b8adf737">_crged</a> -&gt; cp_mpls ( * (A.<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3551bba4142c3b4a50fb63b6b8adf737">_crged</a>));
<a name="l00131"></a>00131         <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#753faff13c5b08d640f272ac0d395be0">_neutr</a> -&gt; cp_mpls ( * (A.<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#753faff13c5b08d640f272ac0d395be0">_neutr</a>));
<a name="l00132"></a>00132     }
<a name="l00133"></a>00133 
<a name="l00134"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#feadfb3e9d0b176528d363cf255ccf58">00134</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#feadfb3e9d0b176528d363cf255ccf58">rotate</a>(<span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1matrix.html">matrix</a> &amp;M ) {
<a name="l00135"></a>00135         vector &lt; vec &gt;:: iterator iter_pos;
<a name="l00136"></a>00136         <span class="keywordflow">for</span> (iter_pos = <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>.begin();
<a name="l00137"></a>00137              iter_pos &lt;  <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>.end();
<a name="l00138"></a>00138              ++iter_pos){
<a name="l00139"></a>00139              *iter_pos = M * (*iter_pos);
<a name="l00140"></a>00140         }
<a name="l00141"></a>00141         <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#d6dbd7ed1aa3097f1760f3d899905241">centre</a> = M * <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#d6dbd7ed1aa3097f1760f3d899905241">centre</a>;
<a name="l00142"></a>00142     }
<a name="l00143"></a>00143     
<a name="l00144"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#b0ee581bacefa9c66106b2e841b32910">00144</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#b0ee581bacefa9c66106b2e841b32910">rot_orb</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> rot[3][3], vector &lt;unsigned int&gt; <a class="code" href="namespacemerge__orbitals.html#e661cff9a8b946474f1a6fb5280bd474">a</a> ) {
<a name="l00145"></a>00145         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>=0; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>&lt; a.size();<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>++) {
<a name="l00146"></a>00146              <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#bf2006b07fecfd7f0f23439181615b8b">orbitals</a> -&gt; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#b0ee581bacefa9c66106b2e841b32910">rot_orb</a>(a[<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>], rot);
<a name="l00147"></a>00147         }
<a name="l00148"></a>00148     }
<a name="l00149"></a>00149 
<a name="l00150"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8e98685020add6c321e777ab3cd1af78">00150</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8e98685020add6c321e777ab3cd1af78">rot_orb</a>( <span class="keyword">const</span> <span class="keywordtype">double</span> rot[3][3], <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>) {
<a name="l00151"></a>00151         <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#bf2006b07fecfd7f0f23439181615b8b">orbitals</a> -&gt; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#b0ee581bacefa9c66106b2e841b32910">rot_orb</a>(i, rot);        
<a name="l00152"></a>00152     }
<a name="l00153"></a>00153 
<a name="l00154"></a>00154     
<a name="l00155"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#237c8eff3d6807f70539d35c006fb0cd">00155</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#237c8eff3d6807f70539d35c006fb0cd">rot_orb</a>( <span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1matrix.html">matrix</a> &amp;rot, vector &lt;unsigned int&gt; <a class="code" href="namespacemerge__orbitals.html#e661cff9a8b946474f1a6fb5280bd474">a</a> ) {
<a name="l00156"></a>00156         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>=0; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>&lt; a.size();<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>++) {
<a name="l00157"></a>00157              <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#bf2006b07fecfd7f0f23439181615b8b">orbitals</a> -&gt; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#b0ee581bacefa9c66106b2e841b32910">rot_orb</a>(a[<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>], rot);
<a name="l00158"></a>00158         }
<a name="l00159"></a>00159     }
<a name="l00160"></a>00160 
<a name="l00161"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#88e438d744b48c85001ea21d450736bb">00161</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#88e438d744b48c85001ea21d450736bb">rot_orb</a>( <span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1matrix.html">matrix</a> &amp;rot, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>) {
<a name="l00162"></a>00162         <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#bf2006b07fecfd7f0f23439181615b8b">orbitals</a> -&gt; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#b0ee581bacefa9c66106b2e841b32910">rot_orb</a>(i, rot);        
<a name="l00163"></a>00163     }
<a name="l00164"></a>00164     
<a name="l00165"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#06437d0b2919ccc395c8fb54e9b331db">00165</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#06437d0b2919ccc395c8fb54e9b331db">shift</a>(<span class="keywordtype">double</span> <a class="code" href="namespacemerge__orbitals.html#e661cff9a8b946474f1a6fb5280bd474">a</a>[3]) {
<a name="l00166"></a>00166         <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> <a class="code" href="namespacevotca_1_1moo.html#6a44f6663e516c56327f0baf6560f39d9f3d14e2c1203137934a1c1df177808d">A</a>(a);
<a name="l00167"></a>00167         <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#06437d0b2919ccc395c8fb54e9b331db">shift</a>(A);
<a name="l00168"></a>00168     }
<a name="l00169"></a>00169 
<a name="l00170"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#35176ba02753ffd59538f99bdf1e4e42">00170</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#35176ba02753ffd59538f99bdf1e4e42">shift</a>(<span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> &amp;<a class="code" href="namespacemerge__orbitals.html#e661cff9a8b946474f1a6fb5280bd474">a</a> ) {
<a name="l00171"></a>00171         vector &lt; vec &gt;:: iterator iter_pos;
<a name="l00172"></a>00172         <span class="keywordflow">for</span> (iter_pos = <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>.begin();
<a name="l00173"></a>00173              iter_pos &lt;  <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>.end();
<a name="l00174"></a>00174              ++iter_pos) {
<a name="l00175"></a>00175             *iter_pos += a;
<a name="l00176"></a>00176         }
<a name="l00177"></a>00177     }    
<a name="l00178"></a>00178     
<a name="l00179"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3e5162c7d05412cd00c8c0fba378ec23">00179</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3e5162c7d05412cd00c8c0fba378ec23">print</a>(ostream &amp; <a class="code" href="namespacemerge__orbitals.html#0915d6744c7de2234c87abdbc49ec437">out</a>) {
<a name="l00180"></a>00180         out.setf(ios::fixed);
<a name="l00181"></a>00181         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>=0; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a> &lt; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#9065c6a11cf79db77d3649cf21098ee7">N</a> ;<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>++ ) {
<a name="l00182"></a>00182             out &lt;&lt; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#351ed37b65dd1a0fca3fb5254ef29d4d">atom_labels</a>[<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>]._type &lt;&lt; <span class="charliteral">'\t'</span> 
<a name="l00183"></a>00183                 &lt;&lt; <a class="code" href="classvotca_1_1moo_1_1unit.html" title="class for unit conversion">unit&lt;bohr,A&gt;::to</a>(<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>].getX()) &lt;&lt; <span class="charliteral">'\t'</span>
<a name="l00184"></a>00184                 &lt;&lt; <a class="code" href="classvotca_1_1moo_1_1unit.html" title="class for unit conversion">unit&lt;bohr,A&gt;::to</a>(<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>].getY()) &lt;&lt; <span class="charliteral">'\t'</span>
<a name="l00185"></a>00185                 &lt;&lt; <a class="code" href="classvotca_1_1moo_1_1unit.html" title="class for unit conversion">unit&lt;bohr,A&gt;::to</a>(<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>].getZ()) &lt;&lt; <span class="charliteral">'\t'</span>
<a name="l00186"></a>00186                 &lt;&lt; <span class="charliteral">'\n'</span> ;
<a name="l00187"></a>00187         }
<a name="l00188"></a>00188     }
<a name="l00189"></a>00189      
<a name="l00190"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#0633574f628da9223066dccc7655ee98">00190</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#0633574f628da9223066dccc7655ee98">print</a>() {
<a name="l00191"></a>00191         <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#0633574f628da9223066dccc7655ee98">print</a>(cout);
<a name="l00192"></a>00192     }
<a name="l00193"></a>00193                 
<a name="l00194"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#6d6a14e385d1a0b04646a436d077eedb">00194</a>     <span class="keyword">inline</span> <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#6d6a14e385d1a0b04646a436d077eedb">getlbl</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a> )<span class="keyword"> const </span>{
<a name="l00195"></a>00195         <span class="keywordflow">return</span> (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#351ed37b65dd1a0fca3fb5254ef29d4d">atom_labels</a>[i])._lbl;
<a name="l00196"></a>00196     }
<a name="l00197"></a>00197                 
<a name="l00198"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#c3d8c8c0f488ac92572b3b752fdcf281">00198</a>     <span class="keyword">inline</span> <span class="keywordtype">string</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#c3d8c8c0f488ac92572b3b752fdcf281">gettype</a> (<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a> )<span class="keyword"> const </span>{
<a name="l00199"></a>00199         <span class="keywordflow">return</span> (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#351ed37b65dd1a0fca3fb5254ef29d4d">atom_labels</a>[i])._type;
<a name="l00200"></a>00200     }
<a name="l00201"></a>00201 
<a name="l00202"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#9e398402e79089a5154b1a8a13fdfb45">00202</a>     <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#9e398402e79089a5154b1a8a13fdfb45">getN</a>()<span class="keyword"> const </span>{
<a name="l00203"></a>00203         <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#9065c6a11cf79db77d3649cf21098ee7">N</a>;
<a name="l00204"></a>00204     }
<a name="l00205"></a>00205 
<a name="l00206"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#e8d03683e7f56a51920a22b87fee606e">00206</a>     <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#e8d03683e7f56a51920a22b87fee606e">getNBasis</a>()<span class="keyword"> const </span>{
<a name="l00207"></a>00207         <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#bf2006b07fecfd7f0f23439181615b8b">orbitals</a>-&gt;<a class="code" href="classvotca_1_1moo_1_1orb.html#2d6100d323cb1787406fa3de4cf8dffe">getNBasis</a>();
<a name="l00208"></a>00208     }
<a name="l00209"></a>00209 
<a name="l00210"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#991a84ed856a3d7319836a77a3f9207c">00210</a>     <a class="code" href="classvotca_1_1moo_1_1orb.html">orb</a> * <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#991a84ed856a3d7319836a77a3f9207c">getorbs</a>()<span class="keyword"> const </span>{
<a name="l00211"></a>00211         <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#bf2006b07fecfd7f0f23439181615b8b">orbitals</a>;
<a name="l00212"></a>00212     }
<a name="l00213"></a>00213     
<a name="l00214"></a>00214     <span class="comment">/*inline double * getorb(const int &amp; i) const {</span>
<a name="l00215"></a>00215 <span class="comment">        return orbitals-&gt;getorb(i);</span>
<a name="l00216"></a>00216 <span class="comment">    }*/</span>
<a name="l00217"></a>00217  
<a name="l00218"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#e3a21fdf969ad77d2c88adb746227321">00218</a>     <span class="keyword">inline</span> <span class="keywordtype">double</span> * <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#e3a21fdf969ad77d2c88adb746227321">getorb</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> &amp; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>)<span class="keyword"> const </span>{
<a name="l00219"></a>00219         <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#bf2006b07fecfd7f0f23439181615b8b">orbitals</a>-&gt;<a class="code" href="classvotca_1_1moo_1_1orb.html#a41acfa62e74c498871eb55b74195d27">getorb</a>(i);
<a name="l00220"></a>00220     }
<a name="l00221"></a>00221 
<a name="l00222"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#1095c4267bfd6241b9a3c3a451607219">00222</a>     <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#1095c4267bfd6241b9a3c3a451607219">getx</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>)<span class="keyword"> const </span>{
<a name="l00223"></a>00223         <span class="keywordflow">return</span> (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[i]).getX();
<a name="l00224"></a>00224     }
<a name="l00225"></a>00225 
<a name="l00226"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#1c4190d4f2839a28c52cd2441f98239c">00226</a>     <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#1c4190d4f2839a28c52cd2441f98239c">gety</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>)<span class="keyword"> const </span>{
<a name="l00227"></a>00227         <span class="keywordflow">return</span> (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[i]).getY();
<a name="l00228"></a>00228     }
<a name="l00229"></a>00229 
<a name="l00230"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3578e8398dbde85f7e8016b443a64e18">00230</a>      <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">double</span> &amp; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3578e8398dbde85f7e8016b443a64e18">getz</a>( <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>)<span class="keyword"> const </span>{
<a name="l00231"></a>00231         <span class="keywordflow">return</span> (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[i]).getZ();
<a name="l00232"></a>00232     }
<a name="l00233"></a>00233      
<a name="l00234"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8a29c64fef70c808db7da319c0db2ff2">00234</a>      <span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> &amp; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8a29c64fef70c808db7da319c0db2ff2">GetPos</a> ( <span class="keyword">const</span> <span class="keywordtype">int</span> &amp; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a> )<span class="keyword"> const </span>{
<a name="l00235"></a>00235          <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[i];
<a name="l00236"></a>00236      }
<a name="l00237"></a>00237      
<a name="l00238"></a>00238      
<a name="l00239"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#d28827363a70d15d073a78ea744b48cf">00239</a>      <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">int</span>  &amp; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#d28827363a70d15d073a78ea744b48cf">get_nel_at</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>)<span class="keyword"> const </span>{
<a name="l00240"></a>00240          <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#371896629902b6c26c9ac779c7d60a25">_bs</a>-&gt;<a class="code" href="classvotca_1_1moo_1_1basis__set.html#bd70f05471ed66836d96bd60408958ff">get_nel_at</a>(<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#351ed37b65dd1a0fca3fb5254ef29d4d">atom_labels</a>[i]._lbl);
<a name="l00241"></a>00241      }
<a name="l00242"></a>00242      
<a name="l00243"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#52f5944abd5c335bbb93e825609803dc">00243</a>      <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">int</span>  &amp; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#52f5944abd5c335bbb93e825609803dc">get_nbasis_at</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> &amp; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>)<span class="keyword"> const </span>{
<a name="l00244"></a>00244          <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#371896629902b6c26c9ac779c7d60a25">_bs</a>-&gt;<a class="code" href="classvotca_1_1moo_1_1basis__set.html#2d446eb7259335d889388252b542e6e8">get_nbasis_at</a>(<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#351ed37b65dd1a0fca3fb5254ef29d4d">atom_labels</a>[i]._lbl);
<a name="l00245"></a>00245      }
<a name="l00246"></a>00246 
<a name="l00247"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#1c276ba6c68cc5148a52b55ab073e029">00247</a>      <a class="code" href="classvotca_1_1moo_1_1basis__set.html">basis_set</a> * <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#1c276ba6c68cc5148a52b55ab073e029">get_basis</a>()<span class="keyword"> const</span>{
<a name="l00248"></a>00248          <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#371896629902b6c26c9ac779c7d60a25">_bs</a>;
<a name="l00249"></a>00249      }
<a name="l00250"></a>00250 
<a name="l00251"></a>00251     <span class="comment">/*const double &amp; get_mpls(const int &amp; i ) const{</span>
<a name="l00252"></a>00252 <span class="comment">        return _charge-&gt;get_mpl(i);</span>
<a name="l00253"></a>00253 <span class="comment">     }*/</span>
<a name="l00254"></a>00254      
<a name="l00256"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#fffcd1f986810db594f8a6f26d39ac63">00256</a>      <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#fffcd1f986810db594f8a6f26d39ac63" title="makes a list of start orbital on an atom and number if basis sets on that atom">assign_orb</a> ( <a class="code" href="classvotca_1_1moo_1_1orb.html">orb</a> * orb1){
<a name="l00257"></a>00257          <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#bf2006b07fecfd7f0f23439181615b8b">orbitals</a> = orb1;
<a name="l00258"></a>00258          <span class="comment">//determine the vector of pairs.</span>
<a name="l00259"></a>00259          vector &lt; pair &lt; int, int&gt; &gt; basis_on_atom;
<a name="l00260"></a>00260          vector &lt;atom_type&gt;::iterator it_at_type;
<a name="l00261"></a>00261          <span class="keywordtype">int</span> beg = 0;
<a name="l00262"></a>00262          <span class="keywordtype">int</span> nbasis;
<a name="l00263"></a>00263          <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8b60a14a678017f76ec77492d019b6c3">n_el</a> = 0;
<a name="l00264"></a>00264          <span class="keywordflow">for</span> (it_at_type = <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#351ed37b65dd1a0fca3fb5254ef29d4d">atom_labels</a>.begin();
<a name="l00265"></a>00265               it_at_type != <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#351ed37b65dd1a0fca3fb5254ef29d4d">atom_labels</a>.end();
<a name="l00266"></a>00266               ++it_at_type){
<a name="l00267"></a>00267 
<a name="l00268"></a>00268              pair &lt;int, int&gt; basis_fo; 
<a name="l00269"></a>00269              basis_fo.first = beg;
<a name="l00270"></a>00270              basis_fo.second = <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#371896629902b6c26c9ac779c7d60a25">_bs</a> -&gt; <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#52f5944abd5c335bbb93e825609803dc">get_nbasis_at</a>(it_at_type -&gt; _lbl);
<a name="l00271"></a>00271              basis_on_atom.push_back(basis_fo);
<a name="l00272"></a>00272              beg += basis_fo.second;
<a name="l00273"></a>00273 
<a name="l00274"></a>00274              <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8b60a14a678017f76ec77492d019b6c3">n_el</a> +=<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#371896629902b6c26c9ac779c7d60a25">_bs</a>-&gt;<a class="code" href="classvotca_1_1moo_1_1basis__set.html#bd70f05471ed66836d96bd60408958ff">get_nel_at</a>(it_at_type -&gt; _lbl);
<a name="l00275"></a>00275          }
<a name="l00276"></a>00276          orb1 -&gt; assign_basis_set(<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#371896629902b6c26c9ac779c7d60a25">_bs</a>, basis_on_atom);
<a name="l00277"></a>00277      }
<a name="l00278"></a>00278      
<a name="l00279"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#004e7ff7792f7ce2c44b7c5b9e94fc97">00279</a>      <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#004e7ff7792f7ce2c44b7c5b9e94fc97">assign_charge</a> (<a class="code" href="classvotca_1_1moo_1_1multipoles.html">multipoles</a> * crg1, <a class="code" href="classvotca_1_1moo_1_1multipoles.html">multipoles</a> * crg2) {
<a name="l00280"></a>00280          <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3551bba4142c3b4a50fb63b6b8adf737">_crged</a> = crg1;
<a name="l00281"></a>00281          <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#753faff13c5b08d640f272ac0d395be0">_neutr</a> = crg2;
<a name="l00282"></a>00282      }
<a name="l00283"></a>00283 
<a name="l00284"></a>00284    <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#68d2518bf3d922907dce67f85b24a37a">init</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> * );
<a name="l00285"></a>00285 
<a name="l00286"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#56e108e9242ba9011cb9263803e45a77">00286</a>    <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#56e108e9242ba9011cb9263803e45a77">init</a>( <span class="keywordtype">char</span> * <a class="code" href="namespacemerge__orbitals.html#e661cff9a8b946474f1a6fb5280bd474">a</a>) {
<a name="l00287"></a>00287         <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="namespacevotca_1_1moo.html#6a44f6663e516c56327f0baf6560f39d9f3d14e2c1203137934a1c1df177808d">A</a> = a;
<a name="l00288"></a>00288         <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#68d2518bf3d922907dce67f85b24a37a">init</a> (A);
<a name="l00289"></a>00289         <span class="keywordflow">return</span> 0;
<a name="l00290"></a>00290     }
<a name="l00291"></a>00291 
<a name="l00292"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#708ca7ff90c3798a4b29db4bc2f624c3">00292</a>    <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#708ca7ff90c3798a4b29db4bc2f624c3">getNEl</a>() { <span class="keywordflow">return</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8b60a14a678017f76ec77492d019b6c3">n_el</a>; }
<a name="l00293"></a>00293    
<a name="l00294"></a>00294 
<a name="l00295"></a>00295    <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#8e284a23629e6cf335fbfce648358c32">init_orbitals</a> (<a class="code" href="classvotca_1_1moo_1_1orb.html">orb</a> &amp;,  <span class="keyword">const</span> <span class="keywordtype">char</span> * );
<a name="l00296"></a>00296    <span class="keywordtype">int</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#eaa3e1eaab77fa755d988a331064ac6b">init_charges</a> ( <span class="keyword">const</span> <span class="keywordtype">char</span> *, <span class="keyword">const</span> <span class="keywordtype">char</span> *);
<a name="l00297"></a>00297    
<a name="l00298"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#02aa690fb6edaea5bf7461deee6119d5">00298</a>    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#02aa690fb6edaea5bf7461deee6119d5">define_bs</a> ( <a class="code" href="classvotca_1_1moo_1_1basis__set.html">basis_set</a> &amp; bs) {
<a name="l00299"></a>00299        <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#371896629902b6c26c9ac779c7d60a25">_bs</a> = &amp;bs;
<a name="l00300"></a>00300    }
<a name="l00301"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#a1f8309b85452a608ec3e442fd7f71f2">00301</a>    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#a1f8309b85452a608ec3e442fd7f71f2">define_bs</a> ( <a class="code" href="classvotca_1_1moo_1_1basis__set.html">basis_set</a> *bs) {
<a name="l00302"></a>00302        <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#371896629902b6c26c9ac779c7d60a25">_bs</a> = bs;
<a name="l00303"></a>00303    }
<a name="l00304"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#359c27a394f597265b1a0f7fd9d4b226">00304</a>    <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#359c27a394f597265b1a0f7fd9d4b226">set_basis_set</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> &amp; <a class="code" href="namespacemerge__orbitals.html#e661cff9a8b946474f1a6fb5280bd474">a</a>){
<a name="l00305"></a>00305        <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#371896629902b6c26c9ac779c7d60a25">_bs</a>-&gt;<a class="code" href="classvotca_1_1moo_1_1basis__set.html#90b33f8554d34d484499f65330cf78b9">set_basis_set</a>(a);
<a name="l00306"></a>00306    }
<a name="l00307"></a>00307 
<a name="l00308"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#e73b78cf3aeea0449e024b7e4439fb4d">00308</a>     <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#e73b78cf3aeea0449e024b7e4439fb4d">V_mpls_neutr</a>(<a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> &amp;<a class="code" href="namespacemerge__orbitals.html#e661cff9a8b946474f1a6fb5280bd474">a</a>){ <span class="comment">//returns V for potential</span>
<a name="l00309"></a>00309         <span class="keywordtype">double</span> V=0.0; 
<a name="l00310"></a>00310         <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> dist;
<a name="l00311"></a>00311         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>=0;<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>&lt;<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#9065c6a11cf79db77d3649cf21098ee7">N</a>;<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>++) {
<a name="l00312"></a>00312              dist = a-<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>];
<a name="l00313"></a>00313              <span class="keywordtype">double</span> <a class="code" href="kmc__old_8cc.html#e243e7fff6a6d0eecd4adaa52b0fe8a2">r</a> = <a class="code" href="namespacevotca_1_1tools.html#bc0c90bbc5f6f5ad2695b3377f7e5684">abs</a>(dist);
<a name="l00314"></a>00314              V +=  <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#753faff13c5b08d640f272ac0d395be0">_neutr</a>-&gt;<a class="code" href="classvotca_1_1moo_1_1multipoles.html#46f3ef7f1d5c01a71e0aeafce4b823b1">get_mpl</a>(<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>) / r;
<a name="l00315"></a>00315         }
<a name="l00316"></a>00316         <span class="keywordflow">return</span> V;
<a name="l00317"></a>00317     }
<a name="l00318"></a>00318     
<a name="l00319"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#4d0e4096599a57c8c870d8d0bdb7a69b">00319</a>     <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#4d0e4096599a57c8c870d8d0bdb7a69b">V_mpls_crg</a>(<a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> &amp;<a class="code" href="namespacemerge__orbitals.html#e661cff9a8b946474f1a6fb5280bd474">a</a>){ <span class="comment">//returns V for potential</span>
<a name="l00320"></a>00320         <span class="keywordtype">double</span> V=0.0; 
<a name="l00321"></a>00321         <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> dist;
<a name="l00322"></a>00322         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>=0;<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>&lt;<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#9065c6a11cf79db77d3649cf21098ee7">N</a>;<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>++) {
<a name="l00323"></a>00323              dist = a-<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>];
<a name="l00324"></a>00324              <span class="keywordtype">double</span> <a class="code" href="kmc__old_8cc.html#e243e7fff6a6d0eecd4adaa52b0fe8a2">r</a> = <a class="code" href="namespacevotca_1_1tools.html#bc0c90bbc5f6f5ad2695b3377f7e5684">abs</a>(dist);
<a name="l00325"></a>00325              V +=  <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3551bba4142c3b4a50fb63b6b8adf737">_crged</a>-&gt;<a class="code" href="classvotca_1_1moo_1_1multipoles.html#46f3ef7f1d5c01a71e0aeafce4b823b1">get_mpl</a>(<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>) /  ( r );
<a name="l00326"></a>00326         }
<a name="l00327"></a>00327         <span class="keywordflow">return</span> V;
<a name="l00328"></a>00328     }
<a name="l00329"></a>00329     
<a name="l00330"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#28898302a76a40cee5bb8a7f4e370373">00330</a>     <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#28898302a76a40cee5bb8a7f4e370373">V_nrg_neutr_neutr</a>(<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html">mol_and_orb</a> &amp; <a class="code" href="namespacemerge__orbitals.html#e661cff9a8b946474f1a6fb5280bd474">a</a>){
<a name="l00331"></a>00331         <span class="keywordtype">double</span> V=0;
<a name="l00332"></a>00332         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>=0; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>&lt;<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#9065c6a11cf79db77d3649cf21098ee7">N</a>;<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>++){
<a name="l00333"></a>00333             V += <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#753faff13c5b08d640f272ac0d395be0">_neutr</a>-&gt;<a class="code" href="classvotca_1_1moo_1_1multipoles.html#46f3ef7f1d5c01a71e0aeafce4b823b1">get_mpl</a>(<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>) * a.<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#e73b78cf3aeea0449e024b7e4439fb4d">V_mpls_neutr</a>(<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>]);
<a name="l00334"></a>00334         }
<a name="l00335"></a>00335         <span class="keywordflow">return</span> V;
<a name="l00336"></a>00336     }
<a name="l00337"></a>00337     
<a name="l00338"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#92984188f378811b79e114364b5abf48">00338</a>     <span class="keywordtype">double</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#92984188f378811b79e114364b5abf48">V_nrg_crg_neutr</a>(<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html">mol_and_orb</a> &amp; <a class="code" href="namespacemerge__orbitals.html#e661cff9a8b946474f1a6fb5280bd474">a</a>){
<a name="l00339"></a>00339         <span class="keywordtype">double</span> V=0;
<a name="l00340"></a>00340         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>=0; <a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>&lt;<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#9065c6a11cf79db77d3649cf21098ee7">N</a>;<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>++){
<a name="l00341"></a>00341             V += <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#3551bba4142c3b4a50fb63b6b8adf737">_crged</a>-&gt;<a class="code" href="classvotca_1_1moo_1_1multipoles.html#46f3ef7f1d5c01a71e0aeafce4b823b1">get_mpl</a>(<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>) * a.<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#e73b78cf3aeea0449e024b7e4439fb4d">V_mpls_neutr</a>(<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[<a class="code" href="namespacedensity__symmetrize.html#70312de6d597e9aea75ba426b32aa62c">i</a>]);
<a name="l00342"></a>00342         }
<a name="l00343"></a>00343         <span class="keywordflow">return</span> V;
<a name="l00344"></a>00344     }
<a name="l00345"></a>00345     
<a name="l00346"></a>00346     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#df02249ac640d19486c58e982c2b4ffc">write_pdb</a>(<span class="keywordtype">string</span>,<span class="keywordtype">string</span>, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;);
<a name="l00347"></a>00347 
<a name="l00348"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#2f69f6b1f5f12ce101acf96cb1913270">00348</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#2f69f6b1f5f12ce101acf96cb1913270">rotate_someatoms</a>(vector &lt;int&gt; list_at,
<a name="l00349"></a>00349                           <span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1matrix.html">matrix</a>  &amp; M,
<a name="l00350"></a>00350                           <span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> &amp; <a class="code" href="namespacemerge__orbitals.html#e661cff9a8b946474f1a6fb5280bd474">a</a>,
<a name="l00351"></a>00351                           <span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> &amp; com,
<a name="l00352"></a>00352                           <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html">mol_and_orb</a> * mol2) {
<a name="l00353"></a>00353         vector &lt;int&gt;::iterator it_at ;
<a name="l00354"></a>00354         
<a name="l00355"></a>00355         <span class="keywordflow">if</span> (<a class="code" href="classvotca_1_1tools_1_1globals.html#68680885a1bd6265f3aacdcca5ab61c4" title="be loud and noisy">globals::verbose</a>) {
<a name="l00356"></a>00356                 cout &lt;&lt; <span class="stringliteral">"translating "</span> &lt;&lt; list_at.size() 
<a name="l00357"></a>00357                      &lt;&lt; <span class="stringliteral">" atoms by distance: "</span> &lt;&lt; a &lt;&lt; endl &lt;&lt;
<a name="l00358"></a>00358                         <span class="stringliteral">" rotating by "</span> &lt;&lt; endl 
<a name="l00359"></a>00359                      &lt;&lt; M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(0,0) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(0,1) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(0,2)  &lt;&lt; endl
<a name="l00360"></a>00360                      &lt;&lt; M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(1,0) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(1,1) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(1,2)  &lt;&lt; endl
<a name="l00361"></a>00361                      &lt;&lt; M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(2,0) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(2,1) &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(2,2)  &lt;&lt; endl;   
<a name="l00362"></a>00362         }
<a name="l00363"></a>00363         
<a name="l00364"></a>00364 <span class="preprocessor">            #ifdef DEBUG</span>
<a name="l00365"></a>00365 <span class="preprocessor"></span>                 cout &lt;&lt; <span class="stringliteral">"about to rotate so many atoms: "</span>
<a name="l00366"></a>00366                  &lt;&lt; list_at.size() &lt;&lt; <span class="stringliteral">" by this distance: "</span>
<a name="l00367"></a>00367                  &lt;&lt; a &lt;&lt; endl;
<a name="l00368"></a>00368 <span class="preprocessor">            #endif</span>
<a name="l00369"></a>00369 <span class="preprocessor"></span>
<a name="l00370"></a>00370         <span class="keywordflow">for</span> (it_at = list_at.begin(); it_at != list_at.end(); ++it_at) {
<a name="l00371"></a>00371 
<a name="l00372"></a>00372 <span class="preprocessor">            #ifdef DEBUG</span>
<a name="l00373"></a>00373 <span class="preprocessor"></span>                 cout &lt;&lt; <span class="stringliteral">"rotating atom:"</span> &lt;&lt; *it_at &lt;&lt;endl;
<a name="l00374"></a>00374 <span class="preprocessor">            #endif           </span>
<a name="l00375"></a>00375 <span class="preprocessor"></span>
<a name="l00376"></a>00376             mol2-&gt;<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[*it_at].setX( a.<a class="code" href="classvotca_1_1tools_1_1vec.html#b45304f25d8d52b149491a05b1c09a43" title="read only access to x element">getX</a>() + M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(0,0) * (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[*it_at].getX() - com.<a class="code" href="classvotca_1_1tools_1_1vec.html#b45304f25d8d52b149491a05b1c09a43" title="read only access to x element">getX</a>() ) + M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(0,1) * (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[*it_at].getY() - com.<a class="code" href="classvotca_1_1tools_1_1vec.html#272a8c6a3be544a2b9dd4b9f5960b02f" title="read only access to y element">getY</a>() ) + M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(0,2) * (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[*it_at].getZ() - com.<a class="code" href="classvotca_1_1tools_1_1vec.html#cc1ceb986d70006789a06cf60169dea4" title="read only access to z element">getZ</a>() ));
<a name="l00377"></a>00377             mol2-&gt;<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[*it_at].setY( a.<a class="code" href="classvotca_1_1tools_1_1vec.html#272a8c6a3be544a2b9dd4b9f5960b02f" title="read only access to y element">getY</a>() + M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(1,0) * (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[*it_at].getX() - com.<a class="code" href="classvotca_1_1tools_1_1vec.html#b45304f25d8d52b149491a05b1c09a43" title="read only access to x element">getX</a>() ) + M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(1,1) * (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[*it_at].getY() - com.<a class="code" href="classvotca_1_1tools_1_1vec.html#272a8c6a3be544a2b9dd4b9f5960b02f" title="read only access to y element">getY</a>() ) + M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(1,2) * (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[*it_at].getZ() - com.<a class="code" href="classvotca_1_1tools_1_1vec.html#cc1ceb986d70006789a06cf60169dea4" title="read only access to z element">getZ</a>() ));
<a name="l00378"></a>00378             mol2-&gt;<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[*it_at].setZ( a.<a class="code" href="classvotca_1_1tools_1_1vec.html#cc1ceb986d70006789a06cf60169dea4" title="read only access to z element">getZ</a>() + M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(2,0) * (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[*it_at].getX() - com.<a class="code" href="classvotca_1_1tools_1_1vec.html#b45304f25d8d52b149491a05b1c09a43" title="read only access to x element">getX</a>() ) + M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(2,1) * (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[*it_at].getY() - com.<a class="code" href="classvotca_1_1tools_1_1vec.html#272a8c6a3be544a2b9dd4b9f5960b02f" title="read only access to y element">getY</a>() ) + M.<a class="code" href="classvotca_1_1tools_1_1matrix.html#f72274a89dd778cd1abaf61105d420a4" title="get an element of the matrix">get</a>(2,2) * (<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[*it_at].getZ() - com.<a class="code" href="classvotca_1_1tools_1_1vec.html#cc1ceb986d70006789a06cf60169dea4" title="read only access to z element">getZ</a>() ));
<a name="l00379"></a>00379         }
<a name="l00380"></a>00380     }
<a name="l00381"></a>00381 
<a name="l00382"></a>00382 
<a name="l00383"></a><a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#5a637e52906f208a3772b9b7aab3d502">00383</a>     <span class="keywordtype">void</span> <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#5a637e52906f208a3772b9b7aab3d502">rotate_someatoms_ctp</a>(vector &lt;int&gt; list_at,
<a name="l00384"></a>00384                               <span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1matrix.html">matrix</a>  &amp; M,
<a name="l00385"></a>00385                               <span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> &amp; <a class="code" href="namespacemerge__orbitals.html#e661cff9a8b946474f1a6fb5280bd474">a</a>,
<a name="l00386"></a>00386                               <span class="keyword">const</span> <a class="code" href="classvotca_1_1tools_1_1vec.html" title="Vector class for a 3 component vector.">vec</a> &amp; com,
<a name="l00387"></a>00387                               <a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html">mol_and_orb</a> * mol2) {
<a name="l00388"></a>00388         vector &lt;int&gt;::iterator it_at ;
<a name="l00389"></a>00389 
<a name="l00390"></a>00390         <span class="keywordflow">for</span> (it_at = list_at.begin(); it_at != list_at.end(); ++it_at) {
<a name="l00391"></a>00391 
<a name="l00392"></a>00392             mol2-&gt;<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[*it_at] = M * ( mol2-&gt;<a class="code" href="classvotca_1_1moo_1_1mol__and__orb.html#73228b354168c8f34daece53ea445ed6">atom_pos</a>[*it_at] - com ) + a;
<a name="l00393"></a>00393         }
<a name="l00394"></a>00394     }
<a name="l00395"></a>00395 };
<a name="l00396"></a>00396 
<a name="l00397"></a>00397 }}
<a name="l00398"></a>00398 
<a name="l00399"></a>00399 <span class="preprocessor">#endif //FILE_MOLECULES_EL</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small><a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> </small></address>
</body>
</html>
